(function(z,be){typeof exports=="object"&&typeof module<"u"?module.exports=be():typeof define=="function"&&define.amd?define(be):(z=typeof globalThis<"u"?globalThis:z||self,z.Text2Frame=be())})(this,function(){"use strict";function z(v,n){for(var s=0;s<n.length;s++){const a=n[s];if(typeof a!="string"&&!Array.isArray(a)){for(const c in a)if(c!=="default"&&!(c in v)){const l=Object.getOwnPropertyDescriptor(a,c);l&&Object.defineProperty(v,c,l.get?l:{enumerable:!0,get:()=>a[c]})}}}return Object.freeze(Object.defineProperty(v,Symbol.toStringTag,{value:"Module"}))}function be(v){return v&&v.__esModule&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v}function te(v){if(v.__esModule)return v;var n=v.default;if(typeof n=="function"){var s=function a(){return this instanceof a?Reflect.construct(n,arguments,this.constructor):n.apply(this,arguments)};s.prototype=n.prototype}else s={};return Object.defineProperty(s,"__esModule",{value:!0}),Object.keys(v).forEach(function(a){var c=Object.getOwnPropertyDescriptor(v,a);Object.defineProperty(s,a,c.get?c:{enumerable:!0,get:function(){return v[a]}})}),s}function Et(v){throw new Error('Could not dynamically require "'+v+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var qe={exports:{}};const ne=te(Object.freeze(Object.defineProperty({__proto__:null,default:{}},Symbol.toStringTag,{value:"Module"})));var Ue={exports:{}},De={},ke={};let vt=class extends Error{constructor(n,s,a){super(a),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.code=s,this.exitCode=n,this.nestedError=void 0}},ys=class extends vt{constructor(n){super(1,"commander.invalidArgument",n),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name}};var Ss=ke.CommanderError=vt,Is=ke.InvalidArgumentError=ys;const Pe=te(z({__proto__:null,CommanderError:Ss,InvalidArgumentError:Is,default:ke},[ke])),{InvalidArgumentError:Ls}=Pe;let Ts=class{constructor(n,s){switch(this.description=s||"",this.variadic=!1,this.parseArg=void 0,this.defaultValue=void 0,this.defaultValueDescription=void 0,this.argChoices=void 0,n[0]){case"<":this.required=!0,this._name=n.slice(1,-1);break;case"[":this.required=!1,this._name=n.slice(1,-1);break;default:this.required=!0,this._name=n;break}this._name.length>3&&this._name.slice(-3)==="..."&&(this.variadic=!0,this._name=this._name.slice(0,-3))}name(){return this._name}_concatValue(n,s){return s===this.defaultValue||!Array.isArray(s)?[n]:s.concat(n)}default(n,s){return this.defaultValue=n,this.defaultValueDescription=s,this}argParser(n){return this.parseArg=n,this}choices(n){return this.argChoices=n.slice(),this.parseArg=(s,a)=>{if(!this.argChoices.includes(s))throw new Ls(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(s,a):s},this}argRequired(){return this.required=!0,this}argOptional(){return this.required=!1,this}};function Fs(v){const n=v.name()+(v.variadic===!0?"...":"");return v.required?"<"+n+">":"["+n+"]"}var As=De.Argument=Ts,Ns=De.humanReadableArgName=Fs;const ze=te(z({__proto__:null,Argument:As,default:De,humanReadableArgName:Ns},[De]));var Je={},Xe={};const{humanReadableArgName:Ms}=ze;let Ds=class{constructor(){this.helpWidth=void 0,this.sortSubcommands=!1,this.sortOptions=!1,this.showGlobalOptions=!1}visibleCommands(n){const s=n.commands.filter(a=>!a._hidden);if(n._hasImplicitHelpCommand()){const[,a,c]=n._helpCommandnameAndArgs.match(/([^ ]+) *(.*)/),l=n.createCommand(a).helpOption(!1);l.description(n._helpCommandDescription),c&&l.arguments(c),s.push(l)}return this.sortSubcommands&&s.sort((a,c)=>a.name().localeCompare(c.name())),s}compareOptions(n,s){const a=c=>c.short?c.short.replace(/^-/,""):c.long.replace(/^--/,"");return a(n).localeCompare(a(s))}visibleOptions(n){const s=n.options.filter(l=>!l.hidden),a=n._hasHelpOption&&n._helpShortFlag&&!n._findOption(n._helpShortFlag),c=n._hasHelpOption&&!n._findOption(n._helpLongFlag);if(a||c){let l;a?c?l=n.createOption(n._helpFlags,n._helpDescription):l=n.createOption(n._helpShortFlag,n._helpDescription):l=n.createOption(n._helpLongFlag,n._helpDescription),s.push(l)}return this.sortOptions&&s.sort(this.compareOptions),s}visibleGlobalOptions(n){if(!this.showGlobalOptions)return[];const s=[];for(let a=n.parent;a;a=a.parent){const c=a.options.filter(l=>!l.hidden);s.push(...c)}return this.sortOptions&&s.sort(this.compareOptions),s}visibleArguments(n){return n._argsDescription&&n.registeredArguments.forEach(s=>{s.description=s.description||n._argsDescription[s.name()]||""}),n.registeredArguments.find(s=>s.description)?n.registeredArguments:[]}subcommandTerm(n){const s=n.registeredArguments.map(a=>Ms(a)).join(" ");return n._name+(n._aliases[0]?"|"+n._aliases[0]:"")+(n.options.length?" [options]":"")+(s?" "+s:"")}optionTerm(n){return n.flags}argumentTerm(n){return n.name()}longestSubcommandTermLength(n,s){return s.visibleCommands(n).reduce((a,c)=>Math.max(a,s.subcommandTerm(c).length),0)}longestOptionTermLength(n,s){return s.visibleOptions(n).reduce((a,c)=>Math.max(a,s.optionTerm(c).length),0)}longestGlobalOptionTermLength(n,s){return s.visibleGlobalOptions(n).reduce((a,c)=>Math.max(a,s.optionTerm(c).length),0)}longestArgumentTermLength(n,s){return s.visibleArguments(n).reduce((a,c)=>Math.max(a,s.argumentTerm(c).length),0)}commandUsage(n){let s=n._name;n._aliases[0]&&(s=s+"|"+n._aliases[0]);let a="";for(let c=n.parent;c;c=c.parent)a=c.name()+" "+a;return a+s+" "+n.usage()}commandDescription(n){return n.description()}subcommandDescription(n){return n.summary()||n.description()}optionDescription(n){const s=[];return n.argChoices&&s.push(`choices: ${n.argChoices.map(a=>JSON.stringify(a)).join(", ")}`),n.defaultValue!==void 0&&(n.required||n.optional||n.isBoolean()&&typeof n.defaultValue=="boolean")&&s.push(`default: ${n.defaultValueDescription||JSON.stringify(n.defaultValue)}`),n.presetArg!==void 0&&n.optional&&s.push(`preset: ${JSON.stringify(n.presetArg)}`),n.envVar!==void 0&&s.push(`env: ${n.envVar}`),s.length>0?`${n.description} (${s.join(", ")})`:n.description}argumentDescription(n){const s=[];if(n.argChoices&&s.push(`choices: ${n.argChoices.map(a=>JSON.stringify(a)).join(", ")}`),n.defaultValue!==void 0&&s.push(`default: ${n.defaultValueDescription||JSON.stringify(n.defaultValue)}`),s.length>0){const a=`(${s.join(", ")})`;return n.description?`${n.description} ${a}`:a}return n.description}formatHelp(n,s){const a=s.padWidth(n,s),c=s.helpWidth||80,l=2,_=2;function O(M,U){if(U){const Ce=`${M.padEnd(a+_)}${U}`;return s.wrap(Ce,c-l,a+_)}return M}function b(M){return M.join(`
`).replace(/^/gm," ".repeat(l))}let y=[`Usage: ${s.commandUsage(n)}`,""];const L=s.commandDescription(n);L.length>0&&(y=y.concat([s.wrap(L,c,0),""]));const N=s.visibleArguments(n).map(M=>O(s.argumentTerm(M),s.argumentDescription(M)));N.length>0&&(y=y.concat(["Arguments:",b(N),""]));const R=s.visibleOptions(n).map(M=>O(s.optionTerm(M),s.optionDescription(M)));if(R.length>0&&(y=y.concat(["Options:",b(R),""])),this.showGlobalOptions){const M=s.visibleGlobalOptions(n).map(U=>O(s.optionTerm(U),s.optionDescription(U)));M.length>0&&(y=y.concat(["Global Options:",b(M),""]))}const Y=s.visibleCommands(n).map(M=>O(s.subcommandTerm(M),s.subcommandDescription(M)));return Y.length>0&&(y=y.concat(["Commands:",b(Y),""])),y.join(`
`)}padWidth(n,s){return Math.max(s.longestOptionTermLength(n,s),s.longestGlobalOptionTermLength(n,s),s.longestSubcommandTermLength(n,s),s.longestArgumentTermLength(n,s))}wrap(n,s,a,c=40){const l=" \\f\\t\\v   -   　\uFEFF",_=new RegExp(`[\\n][${l}]+`);if(n.match(_))return n;const O=s-a;if(O<c)return n;const b=n.slice(0,a),y=n.slice(a).replace(`\r
`,`
`),L=" ".repeat(a),R="\\s​",Y=new RegExp(`
|.{1,${O-1}}([${R}]|$)|[^${R}]+?([${R}]|$)`,"g"),M=y.match(Y)||[];return b+M.map((U,Ce)=>U===`
`?"":(Ce>0?L:"")+U.trimEnd()).join(`
`)}};var ks=Xe.Help=Ds;const Ot=te(z({__proto__:null,Help:ks,default:Xe},[Xe]));var ye={};const{InvalidArgumentError:Ps}=Pe;let $s=class{constructor(n,s){this.flags=n,this.description=s||"",this.required=n.includes("<"),this.optional=n.includes("["),this.variadic=/\w\.\.\.[>\]]$/.test(n),this.mandatory=!1;const a=yt(n);this.short=a.shortFlag,this.long=a.longFlag,this.negate=!1,this.long&&(this.negate=this.long.startsWith("--no-")),this.defaultValue=void 0,this.defaultValueDescription=void 0,this.presetArg=void 0,this.envVar=void 0,this.parseArg=void 0,this.hidden=!1,this.argChoices=void 0,this.conflictsWith=[],this.implied=void 0}default(n,s){return this.defaultValue=n,this.defaultValueDescription=s,this}preset(n){return this.presetArg=n,this}conflicts(n){return this.conflictsWith=this.conflictsWith.concat(n),this}implies(n){let s=n;return typeof n=="string"&&(s={[n]:!0}),this.implied=Object.assign(this.implied||{},s),this}env(n){return this.envVar=n,this}argParser(n){return this.parseArg=n,this}makeOptionMandatory(n=!0){return this.mandatory=!!n,this}hideHelp(n=!0){return this.hidden=!!n,this}_concatValue(n,s){return s===this.defaultValue||!Array.isArray(s)?[n]:s.concat(n)}choices(n){return this.argChoices=n.slice(),this.parseArg=(s,a)=>{if(!this.argChoices.includes(s))throw new Ps(`Allowed choices are ${this.argChoices.join(", ")}.`);return this.variadic?this._concatValue(s,a):s},this}name(){return this.long?this.long.replace(/^--/,""):this.short.replace(/^-/,"")}attributeName(){return Hs(this.name().replace(/^no-/,""))}is(n){return this.short===n||this.long===n}isBoolean(){return!this.required&&!this.optional&&!this.negate}},Vs=class{constructor(n){this.positiveOptions=new Map,this.negativeOptions=new Map,this.dualOptions=new Set,n.forEach(s=>{s.negate?this.negativeOptions.set(s.attributeName(),s):this.positiveOptions.set(s.attributeName(),s)}),this.negativeOptions.forEach((s,a)=>{this.positiveOptions.has(a)&&this.dualOptions.add(a)})}valueFromOption(n,s){const a=s.attributeName();if(!this.dualOptions.has(a))return!0;const c=this.negativeOptions.get(a).presetArg,l=c!==void 0?c:!1;return s.negate===(l===n)}};function Hs(v){return v.split("-").reduce((n,s)=>n+s[0].toUpperCase()+s.slice(1))}function yt(v){let n,s;const a=v.split(/[ |,]+/);return a.length>1&&!/^[[<]/.test(a[1])&&(n=a.shift()),s=a.shift(),!n&&/^-[^-]$/.test(s)&&(n=s,s=void 0),{shortFlag:n,longFlag:s}}var Rs=ye.Option=$s,Bs=ye.splitOptionFlags=yt,js=ye.DualOptions=Vs;const St=te(z({__proto__:null,DualOptions:js,Option:Rs,default:ye,splitOptionFlags:Bs},[ye]));var Ye={};const It=3;function Ws(v,n){if(Math.abs(v.length-n.length)>It)return Math.max(v.length,n.length);const s=[];for(let a=0;a<=v.length;a++)s[a]=[a];for(let a=0;a<=n.length;a++)s[0][a]=a;for(let a=1;a<=n.length;a++)for(let c=1;c<=v.length;c++){let l=1;v[c-1]===n[a-1]?l=0:l=1,s[c][a]=Math.min(s[c-1][a]+1,s[c][a-1]+1,s[c-1][a-1]+l),c>1&&a>1&&v[c-1]===n[a-2]&&v[c-2]===n[a-1]&&(s[c][a]=Math.min(s[c][a],s[c-2][a-2]+1))}return s[v.length][n.length]}function Gs(v,n){if(!n||n.length===0)return"";n=Array.from(new Set(n));const s=v.startsWith("--");s&&(v=v.slice(2),n=n.map(_=>_.slice(2)));let a=[],c=It;const l=.4;return n.forEach(_=>{if(_.length<=1)return;const O=Ws(v,_),b=Math.max(v.length,_.length);(b-O)/b>l&&(O<c?(c=O,a=[_]):O===c&&a.push(_))}),a.sort((_,O)=>_.localeCompare(O)),s&&(a=a.map(_=>`--${_}`)),a.length>1?`
(Did you mean one of ${a.join(", ")}?)`:a.length===1?`
(Did you mean ${a[0]}?)`:""}var xs=Ye.suggestSimilar=Gs;const qs=te(z({__proto__:null,default:Ye,suggestSimilar:xs},[Ye])),Us=ne.EventEmitter,Ke=ne,X=ne,Ze=ne,k=ne,{Argument:zs,humanReadableArgName:Js}=ze,{CommanderError:Qe}=Pe,{Help:Xs}=Ot,{Option:Lt,splitOptionFlags:Ys,DualOptions:Ks}=St,{suggestSimilar:Tt}=qs;class et extends Us{constructor(n){super(),this.commands=[],this.options=[],this.parent=null,this._allowUnknownOption=!1,this._allowExcessArguments=!0,this.registeredArguments=[],this._args=this.registeredArguments,this.args=[],this.rawArgs=[],this.processedArgs=[],this._scriptPath=null,this._name=n||"",this._optionValues={},this._optionValueSources={},this._storeOptionsAsProperties=!1,this._actionHandler=null,this._executableHandler=!1,this._executableFile=null,this._executableDir=null,this._defaultCommandName=null,this._exitCallback=null,this._aliases=[],this._combineFlagAndOptionalValue=!0,this._description="",this._summary="",this._argsDescription=void 0,this._enablePositionalOptions=!1,this._passThroughOptions=!1,this._lifeCycleHooks={},this._showHelpAfterError=!1,this._showSuggestionAfterError=!0,this._outputConfiguration={writeOut:s=>k.stdout.write(s),writeErr:s=>k.stderr.write(s),getOutHelpWidth:()=>k.stdout.isTTY?k.stdout.columns:void 0,getErrHelpWidth:()=>k.stderr.isTTY?k.stderr.columns:void 0,outputError:(s,a)=>a(s)},this._hidden=!1,this._hasHelpOption=!0,this._helpFlags="-h, --help",this._helpDescription="display help for command",this._helpShortFlag="-h",this._helpLongFlag="--help",this._addImplicitHelpCommand=void 0,this._helpCommandName="help",this._helpCommandnameAndArgs="help [command]",this._helpCommandDescription="display help for command",this._helpConfiguration={}}copyInheritedSettings(n){return this._outputConfiguration=n._outputConfiguration,this._hasHelpOption=n._hasHelpOption,this._helpFlags=n._helpFlags,this._helpDescription=n._helpDescription,this._helpShortFlag=n._helpShortFlag,this._helpLongFlag=n._helpLongFlag,this._helpCommandName=n._helpCommandName,this._helpCommandnameAndArgs=n._helpCommandnameAndArgs,this._helpCommandDescription=n._helpCommandDescription,this._helpConfiguration=n._helpConfiguration,this._exitCallback=n._exitCallback,this._storeOptionsAsProperties=n._storeOptionsAsProperties,this._combineFlagAndOptionalValue=n._combineFlagAndOptionalValue,this._allowExcessArguments=n._allowExcessArguments,this._enablePositionalOptions=n._enablePositionalOptions,this._showHelpAfterError=n._showHelpAfterError,this._showSuggestionAfterError=n._showSuggestionAfterError,this}_getCommandAndAncestors(){const n=[];for(let s=this;s;s=s.parent)n.push(s);return n}command(n,s,a){let c=s,l=a;typeof c=="object"&&c!==null&&(l=c,c=null),l=l||{};const[,_,O]=n.match(/([^ ]+) *(.*)/),b=this.createCommand(_);return c&&(b.description(c),b._executableHandler=!0),l.isDefault&&(this._defaultCommandName=b._name),b._hidden=!!(l.noHelp||l.hidden),b._executableFile=l.executableFile||null,O&&b.arguments(O),this.commands.push(b),b.parent=this,b.copyInheritedSettings(this),c?this:b}createCommand(n){return new et(n)}createHelp(){return Object.assign(new Xs,this.configureHelp())}configureHelp(n){return n===void 0?this._helpConfiguration:(this._helpConfiguration=n,this)}configureOutput(n){return n===void 0?this._outputConfiguration:(Object.assign(this._outputConfiguration,n),this)}showHelpAfterError(n=!0){return typeof n!="string"&&(n=!!n),this._showHelpAfterError=n,this}showSuggestionAfterError(n=!0){return this._showSuggestionAfterError=!!n,this}addCommand(n,s){if(!n._name)throw new Error(`Command passed to .addCommand() must have a name
- specify the name in Command constructor or using .name()`);return s=s||{},s.isDefault&&(this._defaultCommandName=n._name),(s.noHelp||s.hidden)&&(n._hidden=!0),this.commands.push(n),n.parent=this,this}createArgument(n,s){return new zs(n,s)}argument(n,s,a,c){const l=this.createArgument(n,s);return typeof a=="function"?l.default(c).argParser(a):l.default(a),this.addArgument(l),this}arguments(n){return n.trim().split(/ +/).forEach(s=>{this.argument(s)}),this}addArgument(n){const s=this.registeredArguments.slice(-1)[0];if(s&&s.variadic)throw new Error(`only the last argument can be variadic '${s.name()}'`);if(n.required&&n.defaultValue!==void 0&&n.parseArg===void 0)throw new Error(`a default value for a required argument is never used: '${n.name()}'`);return this.registeredArguments.push(n),this}addHelpCommand(n,s){return n===!1?this._addImplicitHelpCommand=!1:(this._addImplicitHelpCommand=!0,typeof n=="string"&&(this._helpCommandName=n.split(" ")[0],this._helpCommandnameAndArgs=n),this._helpCommandDescription=s||this._helpCommandDescription),this}_hasImplicitHelpCommand(){return this._addImplicitHelpCommand===void 0?this.commands.length&&!this._actionHandler&&!this._findCommand("help"):this._addImplicitHelpCommand}hook(n,s){const a=["preSubcommand","preAction","postAction"];if(!a.includes(n))throw new Error(`Unexpected value for event passed to hook : '${n}'.
Expecting one of '${a.join("', '")}'`);return this._lifeCycleHooks[n]?this._lifeCycleHooks[n].push(s):this._lifeCycleHooks[n]=[s],this}exitOverride(n){return n?this._exitCallback=n:this._exitCallback=s=>{if(s.code!=="commander.executeSubCommandAsync")throw s},this}_exit(n,s,a){this._exitCallback&&this._exitCallback(new Qe(n,s,a)),k.exit(n)}action(n){const s=a=>{const c=this.registeredArguments.length,l=a.slice(0,c);return this._storeOptionsAsProperties?l[c]=this:l[c]=this.opts(),l.push(this),n.apply(this,l)};return this._actionHandler=s,this}createOption(n,s){return new Lt(n,s)}_callParseArg(n,s,a,c){try{return n.parseArg(s,a)}catch(l){if(l.code==="commander.invalidArgument"){const _=`${c} ${l.message}`;this.error(_,{exitCode:l.exitCode,code:l.code})}throw l}}addOption(n){const s=n.name(),a=n.attributeName();if(n.negate){const l=n.long.replace(/^--no-/,"--");this._findOption(l)||this.setOptionValueWithSource(a,n.defaultValue===void 0?!0:n.defaultValue,"default")}else n.defaultValue!==void 0&&this.setOptionValueWithSource(a,n.defaultValue,"default");this.options.push(n);const c=(l,_,O)=>{l==null&&n.presetArg!==void 0&&(l=n.presetArg);const b=this.getOptionValue(a);l!==null&&n.parseArg?l=this._callParseArg(n,l,b,_):l!==null&&n.variadic&&(l=n._concatValue(l,b)),l==null&&(n.negate?l=!1:n.isBoolean()||n.optional?l=!0:l=""),this.setOptionValueWithSource(a,l,O)};return this.on("option:"+s,l=>{const _=`error: option '${n.flags}' argument '${l}' is invalid.`;c(l,_,"cli")}),n.envVar&&this.on("optionEnv:"+s,l=>{const _=`error: option '${n.flags}' value '${l}' from env '${n.envVar}' is invalid.`;c(l,_,"env")}),this}_optionEx(n,s,a,c,l){if(typeof s=="object"&&s instanceof Lt)throw new Error("To add an Option object use addOption() instead of option() or requiredOption()");const _=this.createOption(s,a);if(_.makeOptionMandatory(!!n.mandatory),typeof c=="function")_.default(l).argParser(c);else if(c instanceof RegExp){const O=c;c=(b,y)=>{const L=O.exec(b);return L?L[0]:y},_.default(l).argParser(c)}else _.default(c);return this.addOption(_)}option(n,s,a,c){return this._optionEx({},n,s,a,c)}requiredOption(n,s,a,c){return this._optionEx({mandatory:!0},n,s,a,c)}combineFlagAndOptionalValue(n=!0){return this._combineFlagAndOptionalValue=!!n,this}allowUnknownOption(n=!0){return this._allowUnknownOption=!!n,this}allowExcessArguments(n=!0){return this._allowExcessArguments=!!n,this}enablePositionalOptions(n=!0){return this._enablePositionalOptions=!!n,this}passThroughOptions(n=!0){if(this._passThroughOptions=!!n,this.parent&&n&&!this.parent._enablePositionalOptions)throw new Error("passThroughOptions can not be used without turning on enablePositionalOptions for parent command(s)");return this}storeOptionsAsProperties(n=!0){if(this.options.length)throw new Error("call .storeOptionsAsProperties() before adding options");return this._storeOptionsAsProperties=!!n,this}getOptionValue(n){return this._storeOptionsAsProperties?this[n]:this._optionValues[n]}setOptionValue(n,s){return this.setOptionValueWithSource(n,s,void 0)}setOptionValueWithSource(n,s,a){return this._storeOptionsAsProperties?this[n]=s:this._optionValues[n]=s,this._optionValueSources[n]=a,this}getOptionValueSource(n){return this._optionValueSources[n]}getOptionValueSourceWithGlobals(n){let s;return this._getCommandAndAncestors().forEach(a=>{a.getOptionValueSource(n)!==void 0&&(s=a.getOptionValueSource(n))}),s}_prepareUserArgs(n,s){if(n!==void 0&&!Array.isArray(n))throw new Error("first parameter to parse must be array or undefined");s=s||{},n===void 0&&(n=k.argv,k.versions&&k.versions.electron&&(s.from="electron")),this.rawArgs=n.slice();let a;switch(s.from){case void 0:case"node":this._scriptPath=n[1],a=n.slice(2);break;case"electron":k.defaultApp?(this._scriptPath=n[1],a=n.slice(2)):a=n.slice(1);break;case"user":a=n.slice(0);break;default:throw new Error(`unexpected parse option { from: '${s.from}' }`)}return!this._name&&this._scriptPath&&this.nameFromFilename(this._scriptPath),this._name=this._name||"program",a}parse(n,s){const a=this._prepareUserArgs(n,s);return this._parseCommand([],a),this}async parseAsync(n,s){const a=this._prepareUserArgs(n,s);return await this._parseCommand([],a),this}_executeSubCommand(n,s){s=s.slice();let a=!1;const c=[".js",".ts",".tsx",".mjs",".cjs"];function l(L,N){const R=X.resolve(L,N);if(Ze.existsSync(R))return R;if(c.includes(X.extname(N)))return;const Y=c.find(M=>Ze.existsSync(`${R}${M}`));if(Y)return`${R}${Y}`}this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();let _=n._executableFile||`${this._name}-${n._name}`,O=this._executableDir||"";if(this._scriptPath){let L;try{L=Ze.realpathSync(this._scriptPath)}catch{L=this._scriptPath}O=X.resolve(X.dirname(L),O)}if(O){let L=l(O,_);if(!L&&!n._executableFile&&this._scriptPath){const N=X.basename(this._scriptPath,X.extname(this._scriptPath));N!==this._name&&(L=l(O,`${N}-${n._name}`))}_=L||_}a=c.includes(X.extname(_));let b;k.platform!=="win32"?a?(s.unshift(_),s=At(k.execArgv).concat(s),b=Ke.spawn(k.argv[0],s,{stdio:"inherit"})):b=Ke.spawn(_,s,{stdio:"inherit"}):(s.unshift(_),s=At(k.execArgv).concat(s),b=Ke.spawn(k.execPath,s,{stdio:"inherit"})),b.killed||["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"].forEach(N=>{k.on(N,()=>{b.killed===!1&&b.exitCode===null&&b.kill(N)})});const y=this._exitCallback;y?b.on("close",()=>{y(new Qe(k.exitCode||0,"commander.executeSubCommandAsync","(close)"))}):b.on("close",k.exit.bind(k)),b.on("error",L=>{if(L.code==="ENOENT"){const N=O?`searched for local subcommand relative to directory '${O}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory",R=`'${_}' does not exist
 - if '${n._name}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead
 - if the default executable name is not suitable, use the executableFile option to supply a custom name or path
 - ${N}`;throw new Error(R)}else if(L.code==="EACCES")throw new Error(`'${_}' not executable`);if(!y)k.exit(1);else{const N=new Qe(1,"commander.executeSubCommandAsync","(error)");N.nestedError=L,y(N)}}),this.runningCommand=b}_dispatchSubcommand(n,s,a){const c=this._findCommand(n);c||this.help({error:!0});let l;return l=this._chainOrCallSubCommandHook(l,c,"preSubcommand"),l=this._chainOrCall(l,()=>{if(c._executableHandler)this._executeSubCommand(c,s.concat(a));else return c._parseCommand(s,a)}),l}_dispatchHelpCommand(n){n||this.help();const s=this._findCommand(n);return s&&!s._executableHandler&&s.help(),this._dispatchSubcommand(n,[],[this._helpLongFlag||this._helpShortFlag])}_checkNumberOfArguments(){this.registeredArguments.forEach((n,s)=>{n.required&&this.args[s]==null&&this.missingArgument(n.name())}),!(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic)&&this.args.length>this.registeredArguments.length&&this._excessArguments(this.args)}_processArguments(){const n=(a,c,l)=>{let _=c;if(c!==null&&a.parseArg){const O=`error: command-argument value '${c}' is invalid for argument '${a.name()}'.`;_=this._callParseArg(a,c,l,O)}return _};this._checkNumberOfArguments();const s=[];this.registeredArguments.forEach((a,c)=>{let l=a.defaultValue;a.variadic?c<this.args.length?(l=this.args.slice(c),a.parseArg&&(l=l.reduce((_,O)=>n(a,O,_),a.defaultValue))):l===void 0&&(l=[]):c<this.args.length&&(l=this.args[c],a.parseArg&&(l=n(a,l,a.defaultValue))),s[c]=l}),this.processedArgs=s}_chainOrCall(n,s){return n&&n.then&&typeof n.then=="function"?n.then(()=>s()):s()}_chainOrCallHooks(n,s){let a=n;const c=[];return this._getCommandAndAncestors().reverse().filter(l=>l._lifeCycleHooks[s]!==void 0).forEach(l=>{l._lifeCycleHooks[s].forEach(_=>{c.push({hookedCommand:l,callback:_})})}),s==="postAction"&&c.reverse(),c.forEach(l=>{a=this._chainOrCall(a,()=>l.callback(l.hookedCommand,this))}),a}_chainOrCallSubCommandHook(n,s,a){let c=n;return this._lifeCycleHooks[a]!==void 0&&this._lifeCycleHooks[a].forEach(l=>{c=this._chainOrCall(c,()=>l(this,s))}),c}_parseCommand(n,s){const a=this.parseOptions(s);if(this._parseOptionsEnv(),this._parseOptionsImplied(),n=n.concat(a.operands),s=a.unknown,this.args=n.concat(s),n&&this._findCommand(n[0]))return this._dispatchSubcommand(n[0],n.slice(1),s);if(this._hasImplicitHelpCommand()&&n[0]===this._helpCommandName)return this._dispatchHelpCommand(n[1]);if(this._defaultCommandName)return Ft(this,s),this._dispatchSubcommand(this._defaultCommandName,n,s);this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName&&this.help({error:!0}),Ft(this,a.unknown),this._checkForMissingMandatoryOptions(),this._checkForConflictingOptions();const c=()=>{a.unknown.length>0&&this.unknownOption(a.unknown[0])},l=`command:${this.name()}`;if(this._actionHandler){c(),this._processArguments();let _;return _=this._chainOrCallHooks(_,"preAction"),_=this._chainOrCall(_,()=>this._actionHandler(this.processedArgs)),this.parent&&(_=this._chainOrCall(_,()=>{this.parent.emit(l,n,s)})),_=this._chainOrCallHooks(_,"postAction"),_}if(this.parent&&this.parent.listenerCount(l))c(),this._processArguments(),this.parent.emit(l,n,s);else if(n.length){if(this._findCommand("*"))return this._dispatchSubcommand("*",n,s);this.listenerCount("command:*")?this.emit("command:*",n,s):this.commands.length?this.unknownCommand():(c(),this._processArguments())}else this.commands.length?(c(),this.help({error:!0})):(c(),this._processArguments())}_findCommand(n){if(n)return this.commands.find(s=>s._name===n||s._aliases.includes(n))}_findOption(n){return this.options.find(s=>s.is(n))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach(n=>{n.options.forEach(s=>{s.mandatory&&n.getOptionValue(s.attributeName())===void 0&&n.missingMandatoryOptionValue(s)})})}_checkForConflictingLocalOptions(){const n=this.options.filter(a=>{const c=a.attributeName();return this.getOptionValue(c)===void 0?!1:this.getOptionValueSource(c)!=="default"});n.filter(a=>a.conflictsWith.length>0).forEach(a=>{const c=n.find(l=>a.conflictsWith.includes(l.attributeName()));c&&this._conflictingOption(a,c)})}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach(n=>{n._checkForConflictingLocalOptions()})}parseOptions(n){const s=[],a=[];let c=s;const l=n.slice();function _(b){return b.length>1&&b[0]==="-"}let O=null;for(;l.length;){const b=l.shift();if(b==="--"){c===a&&c.push(b),c.push(...l);break}if(O&&!_(b)){this.emit(`option:${O.name()}`,b);continue}if(O=null,_(b)){const y=this._findOption(b);if(y){if(y.required){const L=l.shift();L===void 0&&this.optionMissingArgument(y),this.emit(`option:${y.name()}`,L)}else if(y.optional){let L=null;l.length>0&&!_(l[0])&&(L=l.shift()),this.emit(`option:${y.name()}`,L)}else this.emit(`option:${y.name()}`);O=y.variadic?y:null;continue}}if(b.length>2&&b[0]==="-"&&b[1]!=="-"){const y=this._findOption(`-${b[1]}`);if(y){y.required||y.optional&&this._combineFlagAndOptionalValue?this.emit(`option:${y.name()}`,b.slice(2)):(this.emit(`option:${y.name()}`),l.unshift(`-${b.slice(2)}`));continue}}if(/^--[^=]+=/.test(b)){const y=b.indexOf("="),L=this._findOption(b.slice(0,y));if(L&&(L.required||L.optional)){this.emit(`option:${L.name()}`,b.slice(y+1));continue}}if(_(b)&&(c=a),(this._enablePositionalOptions||this._passThroughOptions)&&s.length===0&&a.length===0){if(this._findCommand(b)){s.push(b),l.length>0&&a.push(...l);break}else if(b===this._helpCommandName&&this._hasImplicitHelpCommand()){s.push(b),l.length>0&&s.push(...l);break}else if(this._defaultCommandName){a.push(b),l.length>0&&a.push(...l);break}}if(this._passThroughOptions){c.push(b),l.length>0&&c.push(...l);break}c.push(b)}return{operands:s,unknown:a}}opts(){if(this._storeOptionsAsProperties){const n={},s=this.options.length;for(let a=0;a<s;a++){const c=this.options[a].attributeName();n[c]=c===this._versionOptionName?this._version:this[c]}return n}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce((n,s)=>Object.assign(n,s.opts()),{})}error(n,s){this._outputConfiguration.outputError(`${n}
`,this._outputConfiguration.writeErr),typeof this._showHelpAfterError=="string"?this._outputConfiguration.writeErr(`${this._showHelpAfterError}
`):this._showHelpAfterError&&(this._outputConfiguration.writeErr(`
`),this.outputHelp({error:!0}));const a=s||{},c=a.exitCode||1,l=a.code||"commander.error";this._exit(c,l,n)}_parseOptionsEnv(){this.options.forEach(n=>{if(n.envVar&&n.envVar in k.env){const s=n.attributeName();(this.getOptionValue(s)===void 0||["default","config","env"].includes(this.getOptionValueSource(s)))&&(n.required||n.optional?this.emit(`optionEnv:${n.name()}`,k.env[n.envVar]):this.emit(`optionEnv:${n.name()}`))}})}_parseOptionsImplied(){const n=new Ks(this.options),s=a=>this.getOptionValue(a)!==void 0&&!["default","implied"].includes(this.getOptionValueSource(a));this.options.filter(a=>a.implied!==void 0&&s(a.attributeName())&&n.valueFromOption(this.getOptionValue(a.attributeName()),a)).forEach(a=>{Object.keys(a.implied).filter(c=>!s(c)).forEach(c=>{this.setOptionValueWithSource(c,a.implied[c],"implied")})})}missingArgument(n){const s=`error: missing required argument '${n}'`;this.error(s,{code:"commander.missingArgument"})}optionMissingArgument(n){const s=`error: option '${n.flags}' argument missing`;this.error(s,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(n){const s=`error: required option '${n.flags}' not specified`;this.error(s,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(n,s){const a=_=>{const O=_.attributeName(),b=this.getOptionValue(O),y=this.options.find(N=>N.negate&&O===N.attributeName()),L=this.options.find(N=>!N.negate&&O===N.attributeName());return y&&(y.presetArg===void 0&&b===!1||y.presetArg!==void 0&&b===y.presetArg)?y:L||_},c=_=>{const O=a(_),b=O.attributeName();return this.getOptionValueSource(b)==="env"?`environment variable '${O.envVar}'`:`option '${O.flags}'`},l=`error: ${c(n)} cannot be used with ${c(s)}`;this.error(l,{code:"commander.conflictingOption"})}unknownOption(n){if(this._allowUnknownOption)return;let s="";if(n.startsWith("--")&&this._showSuggestionAfterError){let c=[],l=this;do{const _=l.createHelp().visibleOptions(l).filter(O=>O.long).map(O=>O.long);c=c.concat(_),l=l.parent}while(l&&!l._enablePositionalOptions);s=Tt(n,c)}const a=`error: unknown option '${n}'${s}`;this.error(a,{code:"commander.unknownOption"})}_excessArguments(n){if(this._allowExcessArguments)return;const s=this.registeredArguments.length,a=s===1?"":"s",l=`error: too many arguments${this.parent?` for '${this.name()}'`:""}. Expected ${s} argument${a} but got ${n.length}.`;this.error(l,{code:"commander.excessArguments"})}unknownCommand(){const n=this.args[0];let s="";if(this._showSuggestionAfterError){const c=[];this.createHelp().visibleCommands(this).forEach(l=>{c.push(l.name()),l.alias()&&c.push(l.alias())}),s=Tt(n,c)}const a=`error: unknown command '${n}'${s}`;this.error(a,{code:"commander.unknownCommand"})}version(n,s,a){if(n===void 0)return this._version;this._version=n,s=s||"-V, --version",a=a||"output the version number";const c=this.createOption(s,a);return this._versionOptionName=c.attributeName(),this.options.push(c),this.on("option:"+c.name(),()=>{this._outputConfiguration.writeOut(`${n}
`),this._exit(0,"commander.version",n)}),this}description(n,s){return n===void 0&&s===void 0?this._description:(this._description=n,s&&(this._argsDescription=s),this)}summary(n){return n===void 0?this._summary:(this._summary=n,this)}alias(n){if(n===void 0)return this._aliases[0];let s=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler&&(s=this.commands[this.commands.length-1]),n===s._name)throw new Error("Command alias can't be the same as its name");return s._aliases.push(n),this}aliases(n){return n===void 0?this._aliases:(n.forEach(s=>this.alias(s)),this)}usage(n){if(n===void 0){if(this._usage)return this._usage;const s=this.registeredArguments.map(a=>Js(a));return[].concat(this.options.length||this._hasHelpOption?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?s:[]).join(" ")}return this._usage=n,this}name(n){return n===void 0?this._name:(this._name=n,this)}nameFromFilename(n){return this._name=X.basename(n,X.extname(n)),this}executableDir(n){return n===void 0?this._executableDir:(this._executableDir=n,this)}helpInformation(n){const s=this.createHelp();return s.helpWidth===void 0&&(s.helpWidth=n&&n.error?this._outputConfiguration.getErrHelpWidth():this._outputConfiguration.getOutHelpWidth()),s.formatHelp(this,s)}_getHelpContext(n){n=n||{};const s={error:!!n.error};let a;return s.error?a=c=>this._outputConfiguration.writeErr(c):a=c=>this._outputConfiguration.writeOut(c),s.write=n.write||a,s.command=this,s}outputHelp(n){let s;typeof n=="function"&&(s=n,n=void 0);const a=this._getHelpContext(n);this._getCommandAndAncestors().reverse().forEach(l=>l.emit("beforeAllHelp",a)),this.emit("beforeHelp",a);let c=this.helpInformation(a);if(s&&(c=s(c),typeof c!="string"&&!Buffer.isBuffer(c)))throw new Error("outputHelp callback must return a string or a Buffer");a.write(c),this._helpLongFlag&&this.emit(this._helpLongFlag),this.emit("afterHelp",a),this._getCommandAndAncestors().forEach(l=>l.emit("afterAllHelp",a))}helpOption(n,s){if(typeof n=="boolean")return this._hasHelpOption=n,this;this._helpFlags=n||this._helpFlags,this._helpDescription=s||this._helpDescription;const a=Ys(this._helpFlags);return this._helpShortFlag=a.shortFlag,this._helpLongFlag=a.longFlag,this}help(n){this.outputHelp(n);let s=k.exitCode||0;s===0&&n&&typeof n!="function"&&n.error&&(s=1),this._exit(s,"commander.help","(outputHelp)")}addHelpText(n,s){const a=["beforeAll","before","after","afterAll"];if(!a.includes(n))throw new Error(`Unexpected value for position to addHelpText.
Expecting one of '${a.join("', '")}'`);const c=`${n}Help`;return this.on(c,l=>{let _;typeof s=="function"?_=s({error:l.error,command:l.command}):_=s,_&&l.write(`${_}
`)}),this}}function Ft(v,n){v._hasHelpOption&&n.find(a=>a===v._helpLongFlag||a===v._helpShortFlag)&&(v.outputHelp(),v._exit(0,"commander.helpDisplayed","(outputHelp)"))}function At(v){return v.map(n=>{if(!n.startsWith("--inspect"))return n;let s,a="127.0.0.1",c="9229",l;return(l=n.match(/^(--inspect(-brk)?)$/))!==null?s=l[1]:(l=n.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null?(s=l[1],/^\d+$/.test(l[3])?c=l[3]:a=l[3]):(l=n.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null&&(s=l[1],a=l[3],c=l[4]),s&&c!=="0"?`${s}=${a}:${parseInt(c)+1}`:n})}var Zs=Je.Command=et;const Qs=te(z({__proto__:null,Command:Zs,default:Je},[Je]));(function(v,n){const{Argument:s}=ze,{Command:a}=Qs,{CommanderError:c,InvalidArgumentError:l}=Pe,{Help:_}=Ot,{Option:O}=St;n=v.exports=new a,n.program=n,n.Command=a,n.Option=O,n.Argument=s,n.Help=_,n.CommanderError=c,n.InvalidArgumentError=l,n.InvalidOptionArgumentError=l})(Ue,Ue.exports);var Nt=Ue.exports;const er=te(Object.freeze(Object.defineProperty({__proto__:null,__moduleExports:Nt,default:be(Nt)},Symbol.toStringTag,{value:"Module"})));qe.exports,function(v){if(function(){typeof PluginManager<"u"&&PluginManager.registerCommand&&(PluginManager.registerCommand("Text2Frame","IMPORT_MESSAGE_TO_EVENT",function(a){const c=a.FileFolder,l=a.FileName,_=a.MapID,O=a.EventID,b=a.PageID,y=a.IsOverwrite;this.pluginCommand("IMPORT_MESSAGE_TO_EVENT",[c,l,_,O,b,y])}),PluginManager.registerCommand("Text2Frame","IMPORT_MESSAGE_TO_CE",function(a){const c=a.FileFolder,l=a.FileName,_=a.CommonEventID,O=a.IsOverwrite;this.pluginCommand("IMPORT_MESSAGE_TO_CE",[c,l,_,O])}));var n=typeof n<"u"?n:{};if(n.Text2Frame={},typeof PluginManager>"u")n.Text2Frame.WindowPosition="Bottom",n.Text2Frame.Background="Window",n.Text2Frame.FileFolder="test",n.Text2Frame.FileName="basic.txt",n.Text2Frame.CommonEventID="1",n.Text2Frame.MapID="1",n.Text2Frame.EventID="1",n.Text2Frame.PageID="1",n.Text2Frame.IsOverwrite=!0,n.Text2Frame.CommentOutChar="%",n.Text2Frame.IsDebug=!1,n.Text2Frame.DisplayMsg=!0,n.Text2Frame.DisplayWarning=!0,n.Text2Frame.TextPath="dummy",n.Text2Frame.MapPath="dummy",n.Text2Frame.CommonEventPath="dummy",globalThis.Game_Interpreter={},Game_Interpreter.prototype={},globalThis.$gameMessage={},$gameMessage.add=function(){};else{n.Text2Frame.Parameters=PluginManager.parameters("Text2Frame"),n.Text2Frame.WindowPosition=String(n.Text2Frame.Parameters["Default Window Position"]),n.Text2Frame.Background=String(n.Text2Frame.Parameters["Default Background"]),n.Text2Frame.FileFolder=String(n.Text2Frame.Parameters["Default Scenario Folder"]),n.Text2Frame.FileName=String(n.Text2Frame.Parameters["Default Scenario File"]),n.Text2Frame.CommonEventID=String(n.Text2Frame.Parameters["Default Common Event ID"]),n.Text2Frame.MapID=String(n.Text2Frame.Parameters["Default MapID"]),n.Text2Frame.EventID=String(n.Text2Frame.Parameters["Default EventID"]),n.Text2Frame.PageID=String(n.Text2Frame.Parameters["Default PageID"]),n.Text2Frame.IsOverwrite=String(n.Text2Frame.Parameters.IsOverwrite)==="true",n.Text2Frame.CommentOutChar=String(n.Text2Frame.Parameters["Comment Out Char"]),n.Text2Frame.IsDebug=String(n.Text2Frame.Parameters.IsDebug)==="true",n.Text2Frame.DisplayMsg=String(n.Text2Frame.Parameters.DisplayMsg)==="true",n.Text2Frame.DisplayWarning=String(n.Text2Frame.Parameters.DisplayWarning)==="true";let a="/",c=".";if(typeof Et<"u"){const l=ne;a=l.sep,c=l.dirname(process.mainModule.filename)}n.Text2Frame.TextPath=`${c}${a}${n.Text2Frame.FileFolder}${a}${n.Text2Frame.FileName}`,n.Text2Frame.MapPath=`${c}${a}data${a}Map${("000"+n.Text2Frame.MapID).slice(-3)}.json`,n.Text2Frame.CommonEventPath=`${c}${a}data${a}CommonEvents.json`}const s=Game_Interpreter.prototype.pluginCommand;Game_Interpreter.prototype.pluginCommand=function(a,c){s.apply(this,arguments),this.pluginCommandText2Frame(a,c)},Game_Interpreter.prototype.pluginCommandText2Frame=function(a,c){const l=function(e){n.Text2Frame.DisplayMsg&&$gameMessage.add(e)},_=function(e){n.Text2Frame.DisplayWarning&&$gameMessage.add(e)},O=function(){return{conditions:{actorId:1,actorValid:!1,itemId:1,itemValid:!1,selfSwitchCh:"A",selfSwitchValid:!1,switch1Id:1,switch1Valid:!1,switch2Id:1,switch2Valid:!1,variableId:1,variableValid:!1,variableValue:0},directionFix:!1,image:{characterIndex:0,characterName:"",direction:2,pattern:0,tileId:0},list:[{code:0,indent:0,parameters:[]}],moveFrequency:3,moveRoute:{list:[{code:0,parameters:[]}],repeat:!0,skippable:!1,wait:!1},moveSpeed:3,moveType:0,priorityType:0,stepAnime:!1,through:!1,trigger:0,walkAnime:!0}};switch(n.Text2Frame.ExecMode=a.toUpperCase(),n.Text2Frame.ExecMode){case"IMPORT_MESSAGE_TO_EVENT":case"メッセージをイベントにインポート":l(`import message to event. 
/ メッセージをイベントにインポートします。`),c[0]&&(n.Text2Frame.FileFolder=c[0]),c[1]&&(n.Text2Frame.FileName=c[1]),c[2]&&(n.Text2Frame.MapID=c[2]),c[3]&&(n.Text2Frame.EventID=c[3]),c[4]&&(c[4].toLowerCase()==="true"||c[4].toLowerCase()==="false")?(n.Text2Frame.IsOverwrite=c[4].toLowerCase()==="true",_("【警告】5番目の引数に上書き判定を設定することは非推奨に"),_("なりました。ページIDを設定してください。上書き判定は6番"),_("目に設定してください。(警告はオプションでOFFにできます)")):c[4]&&(n.Text2Frame.PageID=c[4]),c[5]&&c[5].toLowerCase()==="true"&&(n.Text2Frame.IsOverwrite=!0);break;case"IMPORT_MESSAGE_TO_CE":case"メッセージをコモンイベントにインポート":c.length===4&&(l(`import message to common event. 
/ メッセージをコモンイベントにインポートします。`),n.Text2Frame.ExecMode="IMPORT_MESSAGE_TO_CE",n.Text2Frame.FileFolder=c[0],n.Text2Frame.FileName=c[1],n.Text2Frame.CommonEventID=c[2],n.Text2Frame.IsOverwrite=c[3]==="true");break;case"COMMAND_LINE":n.Text2Frame=Object.assign(n.Text2Frame,c[0]);break;case"LIBRARY_EXPORT":break;default:return}const b={};b.log=function(){n.Text2Frame.IsDebug&&console.debug.apply(console,arguments)},b.error=function(){console.error(Array.prototype.join.call(arguments))};const y=function(e){const r=ne;try{return r.readFileSync(e,{encoding:"utf8"})}catch{throw new Error(`File not found. / ファイルが見つかりません。
`+e)}},L=function(e){try{const r=JSON.parse(y(e));if(typeof r=="object")return r;throw new Error(`Json syntax error. 
ファイルが壊れています。RPG Makerでプロジェクトをセーブし直してください
`+e)}catch{throw new Error(`Json syntax error. 
ファイルが壊れています。RPG Makerでプロジェクトをセーブし直してください
`+e)}},N=function(e,r){const i=ne;try{i.writeFileSync(e,JSON.stringify(r,null,"  "),{encoding:"utf8"})}catch{throw new Error(`Save failed. / 保存に失敗しました。
ファイルが開いていないか確認してください。
`+e)}},R=function(e){return e.replace(/\r\n/g,`
`).replace(/\r/g,`
`)},Y=function(e,r){const i=new RegExp("^ *"+r);return e.split(`
`).filter(p=>!p.match(i)).join(`
`)},M=function(e,r=0){return isNaN(e)||e===""?r:Number(e)},U=function(e){switch(e.toUpperCase()){case"WINDOW":case"ウインドウ":return 0;case"DIM":case"暗くする":case"暗く":return 1;case"TRANSPARENT":case"透明":return 2;default:throw new Error("Syntax error. / 文法エラーです。")}},Ce=function(e){switch(e.toUpperCase()){case"TOP":case"上":return 0;case"MIDDLE":case"中":return 1;case"BOTTOM":case"下":return 2;default:throw new Error("Syntax error. / 文法エラーです。")}},nr=function(e){switch(e.toUpperCase()){case"LEFT":case"左":return 0;case"MIDDLE":case"中":return 1;case"RIGHT":case"右":return 2;default:throw new Error("Syntax error. / 文法エラーです。")}},ie=function(){return{code:101,indent:0,parameters:["",0,U(n.Text2Frame.Background),Ce(n.Text2Frame.WindowPosition),""]}},sr=function(e){return{code:401,indent:0,parameters:[e]}},Se=function(){return{code:0,indent:0,parameters:[]}},rr=function(e){const r={code:355,indent:0,parameters:[""]};return r.parameters[0]=e,r},ar=function(e){const r={code:655,indent:0,parameters:[""]};return r.parameters[0]=e,r},or=function(e){const r={code:356,indent:0,parameters:[""]};return r.parameters[0]=e,r},ir=function(e,r,i,p){const h={},g={code:357,indent:0,parameters:[e,r,i,h]},C=/([^[\]]+)(\[.*\])/i;for(let d=0;d<p.length;d++){const I=p[d].match(C);if(I){const A=I[1]||"",D=I[2].slice(1,-1).split("][")||[];h[A]=D[0]||""}}return g},cr=function(e){const r=/([^[\]]+)(\[.*\])/i,i=e.match(r);if(i){let p=i[1]||"";const h=i[2].slice(1,-1).split("][")||[],g=h[0]||"";return h[1]&&(p=h[1]),{code:657,indent:0,parameters:[p+" = "+g]}}else throw new Error("Syntax error. / 文法エラーです。"+e+" はプラグインコマンドMZの引数として不適切です。")},ur=function(e){const r={code:117,indent:0,parameters:[""]};return r.parameters[0]=e,r},lr=function(e){const r={code:108,indent:0,parameters:[""]};return r.parameters[0]=e,r},mr=function(e){const r={code:408,indent:0,parameters:[""]};return r.parameters[0]=e,r},pr=function(e,r){const i={code:105,indent:0,parameters:[2,!1]};if(e&&(i.parameters[0]=e),r)switch(r.toLowerCase()){case"on":case"オン":case"true":case"no fast forward":case"1":{i.parameters[1]=!0;break}case"off":case"オフ":case"false":case"0":{i.parameters[1]=!1;break}}return i},hr=function(e){return{code:405,indent:0,parameters:[e]}},dr=function(e){const r={code:230,indent:0,parameters:[""]};return r.parameters[0]=e,r},fr=function(){return{code:222,indent:0,parameters:[]}},gr=function(){return{code:221,indent:0,parameters:[]}},tt=function(e,r,i,p){let h=90,g=100,C=0;return typeof r=="number"&&(h=r),typeof i=="number"&&(g=i),typeof p=="number"&&(C=p),{code:241,indent:0,parameters:[{name:e,volume:h,pitch:g,pan:C}]}},_r=function(e,r,i){return tt("",e,r,i)},wr=function(e){let r=10;return typeof e=="number"&&(r=e),{code:242,indent:0,parameters:[r]}},br=function(){return{code:243,indent:0,parameters:[]}},Cr=function(){return{code:244,indent:0,parameters:[]}},Mt=function(e,r,i,p){let h=90,g=100,C=0;return typeof r=="number"&&(h=r),typeof i=="number"&&(g=i),typeof p=="number"&&(C=p),{code:132,indent:0,parameters:[{name:e,volume:h,pitch:g,pan:C}]}},nt=function(e,r,i,p){let h=90,g=100,C=0;return typeof r=="number"&&(h=r),typeof i=="number"&&(g=i),typeof p=="number"&&(C=p),{code:245,indent:0,parameters:[{name:e,volume:h,pitch:g,pan:C}]}},Er=function(e,r,i){return nt("",e,r,i)},vr=function(e){let r=10;return typeof e=="number"&&(r=e),{code:246,indent:0,parameters:[r]}},Dt=function(e,r,i,p){let h=90,g=100,C=0;return typeof r=="number"&&(h=r),typeof i=="number"&&(g=i),typeof p=="number"&&(C=p),{code:250,indent:0,parameters:[{name:e,volume:h,pitch:g,pan:C}]}},Or=function(){return{code:251,indent:0,parameters:[]}},st=function(e,r,i,p){let h=90,g=100,C=0;return typeof r=="number"&&(h=r),typeof i=="number"&&(g=i),typeof p=="number"&&(C=p),{code:249,indent:0,parameters:[{name:e,volume:h,pitch:g,pan:C}]}},yr=function(e,r,i){return st("",e,r,i)},Sr=function(e,r,i){switch(i.toLowerCase()){case"on":case"オン":case"1":case"true":return{code:121,indent:0,parameters:[parseInt(e),parseInt(r),0]};case"off":case"オフ":case"0":case"false":return{code:121,indent:0,parameters:[parseInt(e),parseInt(r),1]}}},se=function(e,r,i,p,h=0,g=0,C=0){const d=[r,i];switch(e.toLowerCase()){case"set":d.push(0);break;case"add":d.push(1);break;case"sub":d.push(2);break;case"mul":d.push(3);break;case"div":d.push(4);break;case"mod":d.push(5);break;default:d.push(0);break}switch(p.toLowerCase()){case"constant":d.push(0),d.push(h);break;case"variables":d.push(1),d.push(h);break;case"random":d.push(2),d.push(parseInt(h)),d.push(parseInt(g));break;case"gamedata":{switch(d.push(3),h=h.toLowerCase(),h){case"item":case"アイテム":d.push(0),d.push(parseInt(g)),d.push(0);break;case"weapon":case"武器":d.push(1),d.push(parseInt(g)),d.push(0);break;case"armor":case"防具":d.push(2),d.push(parseInt(g)),d.push(0);break;case"actor":case"アクター":case"enemy":case"敵キャラ":case"エネミー":{switch(h==="actor"||h==="アクター"?d.push(3):d.push(4),d.push(parseInt(g)),C.toLowerCase()){case"level":case"レベル":{d.push(0);break}case"exp":case"経験値":{d.push(1);break}case"hp":{d.push(2);break}case"mp":{d.push(3);break}case"maxhp":case"最大hp":{d.push(4);break}case"maxmp":case"最大mp":{d.push(5);break}case"attack":case"攻撃力":{d.push(6);break}case"defense":case"防御力":{d.push(7);break}case"m.attack":case"魔法攻撃力":{d.push(8);break}case"m.defense":case"魔法防御力":{d.push(9);break}case"agility":case"敏捷性":{d.push(10);break}case"luck":case"運":{d.push(11);break}default:{d.push(0);break}}if(h==="enemy"||h==="敵キャラ"||h==="エネミー"){let I=d.pop(),A=d.pop();I=I-2,A=A-1,d.push(A),d.push(I)}break}case"character":case"キャラクター":switch(d.push(5),g.toLowerCase()){case"player":case"プレイヤー":case"-1":{d.push(-1);break}case"thisevent":case"このイベント":case"0":{d.push(0);break}default:{d.push(parseInt(g));break}}switch(C.toLowerCase()){case"mapx":case"マップx":{d.push(0);break}case"mapy":case"マップy":{d.push(1);break}case"direction":case"方向":{d.push(2);break}case"screenx":case"画面x":{d.push(3);break}case"screeny":case"画面y":{d.push(4);break}default:{d.push(0);break}}break;case"party":case"パーティ":d.push(6),d.push(parseInt(g)-1),d.push(0);break;case"other":switch(d.push(7),g.toLowerCase()){case"mapid":case"マップid":{d.push(0);break}case"partymembers":case"パーティ人数":{d.push(1);break}case"gold":case"所持金":{d.push(2);break}case"steps":case"歩数":{d.push(3);break}case"playtime":case"プレイ時間":{d.push(4);break}case"timer":case"タイマー":{d.push(5);break}case"savecount":case"セーブ回数":{d.push(6);break}case"battlecount":case"戦闘回数":{d.push(7);break}case"wincount":case"勝利回数":{d.push(8);break}case"escapecount":case"逃走回数":{d.push(9);break}default:{d.push(parseInt(g));break}}d.push(0);break;case"last":case"直前":switch(d.push(8),g.toLowerCase()){case"last used skill id":case"直前に使用したスキルのid":case"used skill id":{d.push(0);break}case"last used item id":case"直前に使用したアイテムのid":case"used item id":{d.push(1);break}case"last actor id to act":case"直前に行動したアクターのid":case"actor id to act":{d.push(2);break}case"last enemy index to act":case"直前に行動した敵キャラのインデックス":case"enemy index to act":{d.push(3);break}case"last target actor id":case"直前に対象となったアクターのid":case"target actor id":{d.push(4);break}case"last target enemy index":case"直前に対象となった敵キャラのインデックス":case"target enemy index":{d.push(5);break}default:{d.push(0);break}}d.push(0);break}break}case"script":{d.push(4),d.push(h);break}default:d.push(0),d.push(h),d.push(g),d.push(C);break}return{code:122,indent:0,parameters:d}},Ir=function(e,r){switch(r.toLowerCase()){case"on":case"オン":case"1":case"true":return{code:123,indent:0,parameters:[e.toUpperCase(),0]};case"off":case"オフ":case"0":case"false":return{code:123,indent:0,parameters:[e.toUpperCase(),1]};default:return{code:123,indent:0,parameters:[e.toUpperCase(),1]}}},kt=function(e,r){switch(e.toLowerCase()){case"start":case"始動":case"スタート":return{code:124,indent:0,parameters:[0,parseInt(r)]};case"stop":case"停止":case"ストップ":return{code:124,indent:0,parameters:[1,parseInt(r)]};default:return{code:124,indent:0,parameters:[1,parseInt(r)]}}},Lr=function(e,r){const i={};let p=0,h=null,g=function(){},C=function(){};switch(r.toLowerCase()){case"script":{h=/<script>([\s\S]*?)<\/script>|<sc>([\s\S]*?)<\/sc>|<スクリプト>([\s\S]*?)<\/スクリプト>/i,g=rr,C=ar;break}case"comment":{h=/<comment>([\s\S]*?)<\/comment>|<co>([\s\S]*?)<\/co>|<注釈>([\s\S]*?)<\/注釈>/i,g=lr,C=mr;break}case"scrolling":{let I=e.match(/<ShowScrollingText\s*:*\s*(\d*)\s*,*\s*([\s\S]*?)>([\s\S]*?)<\/ShowScrollingText>/i)||e.match(/<sst\s*:*\s*(\d*)\s*,*\s*([\s\S]*?)>([\s\S]*?)<\/sst>/i)||e.match(/<文章のスクロール表示\s*:*\s*(\d*)\s*,*\s*([\s\S]*?)>([\s\S]*?)<\/文章のスクロール表示>/i);for(;I!==null;){const A=I[0],D=Number(I[1]),P=I[2],J=I[3].replace(/^\n/,"").replace(/\n$/,"").split(`
`);let B=[];B.push(pr(D,P)),B=B.concat(J.map(K=>hr(K))),i[`#${r.toUpperCase()}_BLOCK${p}#`]=B,e=e.replace(A,`
#${r.toUpperCase()}_BLOCK${p}#
`),p++,I=e.match(/<ShowScrollingText\s*:*\s*(\d*)\s*,*\s*([\s\S]*?)>([\s\S]*?)<\/ShowScrollingText>/i)||e.match(/<sst\s*:*\s*(\d*)\s*,*\s*([\s\S]*?)>([\s\S]*?)<\/sst>/i)||e.match(/<文章のスクロール表示\s*:*\s*(\d*)\s*,*\s*([\s\S]*?)>([\s\S]*?)<\/文章のスクロール表示>/i)}return{scenario_text:e,block_map:i}}}let d=e.match(h);for(;d!==null;){const I=d[0],A=d[1]||d[2]||d[3];e=e.replace(I,`
#${r.toUpperCase()}_BLOCK${p}#
`);const D=A.replace(/^\n/,"").replace(/\n$/,"").split(`
`),P=[];for(let j=0;j<D.length;j++){const J=D[j];j===0?P.push(g(J)):P.push(C(J))}i[`#${r.toUpperCase()}_BLOCK${p}#`]=P,d=e.match(h),p++}return{scenario_text:e,block_map:i}},$e=function(){return{origin:0,variable:0,x:0,y:0,width:100,height:100,opacity:255,blend_mode:0,duration:60,wait:!0,red:0,green:0,blue:0,gray:0,easing:0}},Ve=function(e){const r={},i=/([^[\]]+)(\[[\s\-a-zA-Z0-9\u30a0-\u30ff\u3040-\u309f\u3005-\u3006\u30e0-\u9fcf[\]]+\])/i,p=e.match(i);if(p){const h=p[1]||"",g=p[2].slice(1,-1).split("][")||"";switch(h.toLowerCase()){case"position":case"位置":{const C=g[0]||"Upper Left";(C.toLowerCase()==="center"||C==="中央")&&(r.origin=1);const d=/^[0-9]+$/,I=/(?:variables|v|変数)\[([0-9]+)\]/i,A=g[1]||"0";if(A.match(d))r.variable=0,r.x=Number(A);else{const P=A.match(I);P&&(r.variable=1,r.x=Number(P[1]))}const D=g[2]||"0";if(D.match(d))r.variable=0,r.y=Number(D);else{const P=D.match(I);P&&(r.variable=1,r.y=Number(P[1]))}break}case"scale":case"拡大率":{r.width=M(g[0],100),r.height=M(g[1],100);break}case"blend":case"合成":{r.opacity=M(g[0],255),r.blend_mode={normal:0,通常:0,additive:1,加算:1,multiply:2,乗算:2,screen:3,スクリーン:3}[g[1].toLowerCase()]||0;break}case"duration":case"時間":{r.duration=M(g[0],60),(typeof g[1]>"u"||g[1]==="")&&(r.wait=!1);break}case"colortone":case"色調":case"ct":{switch(g[0].toLowerCase()||0){case"normal":case"通常":{r.red=0,r.green=0,r.blue=0,r.gray=0;break}case"dark":case"ダーク":{r.red=-68,r.green=-68,r.blue=-68,r.gray=0;break}case"sepia":case"セピア":{r.red=34,r.green=-34,r.blue=-68,r.gray=170;break}case"sunset":case"夕暮れ":{r.red=68,r.green=-34,r.blue=-34,r.gray=0;break}case"night":case"夜":{r.red=-68,r.green=-68,r.blue=0,r.gray=68;break}default:{r.red=Number(g[0])||0,r.green=Number(g[1])||0,r.blue=Number(g[2])||0,r.gray=Number(g[3])||0;break}}break}case"easing":case"イージング":{const C=g[0].toLowerCase()||"inear";r.easing={"constant speed":0,一定速度:0,linear:0,"slow start":1,ゆっくり始まる:1,"ease-in":1,"slow end":2,ゆっくり終わる:2,"ease-out":2,"slow start and end":3,ゆっくり始まってゆっくり終わる:3,"ease-in-out":3}[C];break}}}return r},Tr=function(e,r,i=[]){const p=$e();return i.map(h=>Object.assign(p,Ve(h))),{code:231,indent:0,parameters:[e,r,p.origin,p.variable,p.x,p.y,p.width,p.height,p.opacity,p.blend_mode]}},Fr=function(e,r=[]){const i=$e();return r.map(p=>Object.assign(i,Ve(p))),{code:232,indent:0,parameters:[e,0,i.origin,i.variable,i.x,i.y,i.width,i.height,i.opacity,i.blend_mode,i.duration,i.wait,i.easing]}},Ar=function(e,r){return{code:233,indent:0,parameters:[e,r]}},Nr=function(e,r=[]){const i=$e();return r.map(p=>Object.assign(i,Ve(p))),{code:234,indent:0,parameters:[e,[i.red,i.green,i.blue,i.gray],i.duration,i.wait]}},Mr=function(e){return{code:235,indent:0,parameters:[e]}},Dr=function(e,r){if(e=Math.max(Number(e)||1,1),typeof r[0]>"u")return[0,e,0];const i={on:0,オン:0,true:0,1:0,off:1,オフ:1,false:1,0:1}[r[0].toLowerCase()];return e>0&&(i===1||i===0)?[0,e,i]:[0,e,0]},kr=function(e,r){e=Math.max(Number(e)||1,1);const i={"==":0,"＝":0,">=":1,"≧":1,"<=":2,"≦":2,">":3,"＞":3,"<":4,"＜":4,"!=":5,"≠":5}[r[0]]||0,p=/^\d+$/,h=/(?:variables|v|変数)\[([0-9]+)\]/i,g=r[1]||"0";if(g.match(p))return[1,e,0,Number(g),i];if(g.match(h)){const C=Math.max(Number(g.match(h)[1]),1);return[1,e,1,C,i]}return[1,e,0,0,0]},Pr=function(e,r){switch(e=e.toUpperCase(),e){case"A":case"B":case"C":case"D":break;default:e="A"}if(typeof r[0]>"u")return[2,e,0];const i={on:0,オン:0,true:0,1:0,off:1,オフ:1,false:1,0:1}[r[0].toLowerCase()];return i===0||i===1?[2,e,i]:[2,e,0]},$r=function(e){const r={">=":0,"≧":0,"<=":1,"≦":1}[e[0]]||0,i=Number(e[1])||0,p=Number(e[2])||0;return[3,60*i+p,r]},Vr=function(e,r){e=Math.max(Number(e)||1,1);const i={"in the party":0,パーティにいる:0,name:1,名前:1,class:2,職業:2,skill:3,スキル:3,weapon:4,武器:4,armor:5,防具:5,state:6,ステート:6}[r[0].toLowerCase()]||0;if(i>0){if(i===1)return[4,e,1,r[1]];if(Number(r[1]))return[4,e,i,Math.max(Number(r[1]),1)]}return[4,e,0]},Hr=function(e,r){e=Math.max(Number(e)||1,1)-1;const i=(r[0]||"appeared").toLowerCase(),p=Math.max(Number(r[1])||1,1);return i==="appeared"||i==="出現している"?[5,e,0]:i==="state"||i==="ステート"?[5,e,1,p]:[5,e,0]},Rr=function(e,r){let i={player:-1,プレイヤー:-1,thisevent:0,このイベント:0}[e.toLowerCase()];typeof i>"u"&&(i=Math.max(Number(e)||0,-1));const p={down:2,下:2,2:2,left:4,左:4,4:4,right:6,右:6,6:6,up:8,上:8,8:8}[(r[0]||"").toLowerCase()]||2;return[6,i,p]},Br=function(e){return[13,{boat:0,小型船:0,ship:1,大型船:1,airship:2,飛行船:2}[(e[0]||"").toLowerCase()]||0]},jr=function(e){const r={">=":0,"≧":0,"<=":1,"≦":1,"<":2,"＜":2}[e[0]]||0;return[7,Number(e[1])||0,r]},Wr=function(e){return e=Math.max(Number(e)||1,1),[8,e]},Gr=function(e,r){e=Math.max(Number(e)||1,1);let i=!1;return r[0]&&(i=!0),[9,e,i]},xr=function(e,r){e=Math.max(Number(e)||1,1);let i=!1;return r[0]&&(i=!0),[10,e,i]},qr=function(e){const r={ok:"ok",決定:"ok",cancel:"cancel",キャンセル:"cancel",shift:"shift",シフト:"shift",down:"down",下:"down",left:"left",左:"left",right:"right",右:"right",up:"up",上:"up",pageup:"pageup",ページアップ:"pageup",pagedown:"pagedown",ページダウン:"pagedown"}[(e[0]||"").toLowerCase()]||"ok",i={"is being pressed":0,が押されている:0,pressed:0,"is being triggered":1,がトリガーされている:1,triggered:1,"is being repeated":2,がリピートされている:2,repeated:2}[(e[1]||"").toLowerCase()]||0;return[11,r,i]},Ur=function(e){return[12,e.join(",").trim()]},zr=function(e,r){const i={code:111,indent:0,parameters:[0,1,0]},p=/([^[\]]+)(\[[\s\-a-zA-Z0-9\u30a0-\u30ff\u3040-\u309f\u3005-\u3006\u30e0-\u9fcf[\]]+\])*/i;e=e.match(p);const h=e[1],g=(e[2]||"").replace(/[[\]]/g,"");switch(h.toLowerCase()){case"script":case"スクリプト":case"sc":break;default:r=r.map(C=>C.trim());break}switch(h.toLowerCase()){case"switches":case"スイッチ":case"sw":{i.parameters=Dr(g,r);break}case"variables":case"変数":case"v":{i.parameters=kr(g,r);break}case"selfswitches":case"セルフスイッチ":case"ssw":{i.parameters=Pr(g,r);break}case"timer":case"タイマー":{i.parameters=$r(r);break}case"actors":case"アクター":{i.parameters=Vr(g,r);break}case"enemies":case"敵キャラ":case"エネミー":{i.parameters=Hr(g,r);break}case"characters":case"キャラクター":{i.parameters=Rr(g,r);break}case"vehicle":case"乗り物":{i.parameters=Br(r);break}case"gold":case"お金":{i.parameters=jr(r);break}case"items":case"アイテム":{i.parameters=Wr(g);break}case"weapons":case"武器":{i.parameters=Gr(g,r);break}case"armors":case"防具":{i.parameters=xr(g,r);break}case"button":case"ボタン":{i.parameters=qr(r);break}case"script":case"スクリプト":case"sc":{i.parameters=Ur(r);break}}return i},Jr=function(){return{code:411,indent:0,parameters:[]}},He=function(){return{code:412,indent:0,parameters:[]}},Xr=function(){return{code:112,indent:0,parameters:[]}},Pt=function(){return{code:413,indent:0,parameters:[]}},Yr=function(){return{code:113,indent:0,parameters:[]}},Ee=function(){return{code:0,indent:0,parameters:[]}},Kr=function(){return{code:115,indent:0,parameters:[]}},Zr=function(e){return{code:118,indent:0,parameters:[e]}},Qr=function(e){return{code:119,indent:0,parameters:[e]}},ea=function(e,r){return{code:103,indent:0,parameters:[e,r]}},ta=function(e,r){let i=1;switch(r.trim().toLowerCase()){case"Regular Item".toLowerCase():case"通常アイテム".toLowerCase():{i=1;break}case"Key Item".toLowerCase():case"大事なもの".toLowerCase():{i=2;break}case"Hidden Item A".toLowerCase():case"隠しアイテムA".toLowerCase():{i=3;break}case"Hidden Item B".toLowerCase():case"隠しアイテムB".toLowerCase():{i=4;break}}return{code:104,indent:0,parameters:[e,i]}},na=function(e,r,i,p){return{code:102,indent:0,parameters:[[],p,i,r,e]}},sa=function(e,r){return{code:402,indent:0,parameters:[e,r]}},ra=function(){return{code:403,indent:0,parameters:[6,null]}},$t=function(){return{code:404,indent:0,parameters:[]}},aa=function(e,r,i){return{code:125,indent:0,parameters:[e,r,i]}},oa=function(e,r,i,p){return{code:126,indent:0,parameters:[e,r,i,p]}},ia=function(e,r,i,p,h){return{code:127,indent:0,parameters:[e,r,i,p,h]}},ca=function(e,r,i,p,h){return{code:128,indent:0,parameters:[e,r,i,p,h]}},ua=function(e,r,i){return{code:129,indent:0,parameters:[e,r,i]}},la=function(e,r,i,p,h,g){return{code:311,indent:0,parameters:[e,r,i,p,h,g]}},ma=function(e,r,i,p,h){return{code:312,indent:0,parameters:[e,r,i,p,h]}},pa=function(e,r,i,p,h){return{code:326,indent:0,parameters:[e,r,i,p,h]}},ha=function(e,r,i,p){return{code:313,indent:0,parameters:[e,r,i,p]}},da=function(e,r){return{code:314,indent:0,parameters:[e,r]}},fa=function(e,r,i,p,h,g){return{code:315,indent:0,parameters:[e,r,i,p,h,g]}},ga=function(e,r,i,p,h,g){return{code:316,indent:0,parameters:[e,r,i,p,h,g]}},_a=function(e,r,i,p,h,g){return{code:317,indent:0,parameters:[e,r,i,p,h,g]}},wa=function(e,r,i,p){return{code:318,indent:0,parameters:[e,r,i,p]}},ba=function(e,r,i){return{code:319,indent:0,parameters:[e,r,i]}},Ca=function(e,r){return{code:320,indent:0,parameters:[e,r]}},Ea=function(e,r,i){return{code:321,indent:0,parameters:[e,r,i]}},va=function(e,r){return{code:324,indent:0,parameters:[e,r]}},Oa=function(e,r){const i=r.replace("\\n",`
`);return{code:325,indent:0,parameters:[e,i]}},ya=function(e,r,i,p,h,g){return{code:201,indent:0,parameters:[e,r,i,p,h,g]}},Sa=function(e,r,i,p,h){return{code:202,indent:0,parameters:[e,r,i,p,h]}},Ia=function(e,r,i,p,h){return{code:203,indent:0,parameters:[e,r,i,p,h]}},La=function(e,r,i,p){return{code:204,indent:0,parameters:[e,r,i,p]}},Ta=function(e,r,i,p){return{code:205,indent:0,parameters:[e,{list:[{code:0}],repeat:r,skippable:i,wait:p}]}},S=function(e){return{code:505,indent:0,parameters:[e]}},Fa=function(){return S({code:1,indent:null})},Aa=function(){return S({code:2,indent:null})},Na=function(){return S({code:3,indent:null})},Ma=function(){return S({code:4,indent:null})},Da=function(){return S({code:5,indent:null})},ka=function(){return S({code:6,indent:null})},Pa=function(){return S({code:7,indent:null})},$a=function(){return S({code:8,indent:null})},Va=function(){return S({code:9,indent:null})},Ha=function(){return S({code:10,indent:null})},Ra=function(){return S({code:11,indent:null})},Ba=function(){return S({code:12,indent:null})},ja=function(){return S({code:13,indent:null})},Wa=function(e,r){return S({code:14,parameters:[e,r],indent:null})},Ga=function(e){return S({code:15,parameters:[e],indent:null})},xa=function(){return S({code:16,indent:null})},qa=function(){return S({code:17,indent:null})},Ua=function(){return S({code:18,indent:null})},za=function(){return S({code:19,indent:null})},Ja=function(){return S({code:20,indent:null})},Xa=function(){return S({code:21,indent:null})},Ya=function(){return S({code:22,indent:null})},Ka=function(){return S({code:23,indent:null})},Za=function(){return S({code:24,indent:null})},Qa=function(){return S({code:25,indent:null})},eo=function(){return S({code:26,indent:null})},to=function(e){return S({code:27,parameters:[e],indent:null})},no=function(e){return S({code:28,parameters:[e],indent:null})},so=function(e){return S({code:29,parameters:[e],indent:null})},ro=function(e){return S({code:30,parameters:[e],indent:null})},ao=function(){return S({code:31,indent:null})},oo=function(){return S({code:32,indent:null})},io=function(){return S({code:33,indent:null})},co=function(){return S({code:34,indent:null})},uo=function(){return S({code:35,indent:null})},lo=function(){return S({code:36,indent:null})},mo=function(){return S({code:37,indent:null})},po=function(){return S({code:38,indent:null})},ho=function(){return S({code:39,indent:null})},fo=function(){return S({code:40,indent:null})},go=function(e,r){return S({code:41,parameters:[e,r],indent:null})},_o=function(e){return S({code:42,parameters:[e],indent:null})},wo=function(e){return S({code:43,parameters:[e],indent:null})},Vt=function(e,r,i,p){let h=90,g=100,C=0;return typeof r=="number"&&(h=r),typeof i=="number"&&(g=i),typeof p=="number"&&(C=p),S({code:44,parameters:[{name:e,volume:h,pitch:g,pan:C}],indent:null})},bo=function(e){return S({code:45,parameters:[e],indent:null})},Co=function(){return{code:206,indent:0,parameters:[]}},Eo=function(e){return{code:211,indent:0,parameters:[e]}},vo=function(e){return{code:216,indent:0,parameters:[e]}},Oo=function(){return{code:217,indent:0,parameters:[]}},yo=function(e,r,i){return{code:212,indent:0,parameters:[e,r,i]}},So=function(e,r,i){return{code:213,indent:0,parameters:[e,r,i]}},Io=function(){return{code:214,indent:0,parameters:[]}},Lo=function(e=[]){const r=$e();return e.map(i=>Object.assign(r,Ve(i))),{code:223,indent:0,parameters:[[r.red,r.green,r.blue,r.gray],r.duration,r.wait]}},To=function(e,r,i,p,h,g){return{code:224,indent:0,parameters:[[e,r,i,p],h,g]}},Fo=function(e,r,i,p){return{code:225,indent:0,parameters:[e,r,i,p]}},Ao=function(e,r,i,p){return{code:236,indent:0,parameters:[e,r,i,p]}},No=function(e){return{code:261,indent:0,parameters:[e]}},Mo=function(e,r){return{code:301,indent:0,parameters:[e,r,!1,!1]}},rt=function(){return{code:601,indent:0,parameters:[]}},Do=function(){return{code:602,indent:0,parameters:[]}},ko=function(){return{code:603,indent:0,parameters:[]}},Ht=function(){return{code:604,indent:0,parameters:[]}},Po=function(e,r){return{code:303,indent:0,parameters:[e,r]}},$o=function(e){return{code:302,indent:0,parameters:[0,0,0,0,e]}},Vo=function(e,r,i,p){return{code:605,indent:0,parameters:[e,r,i,p]}},Ho=function(){return{code:351,indent:0,parameters:[]}},Ro=function(){return{code:352,indent:0,parameters:[]}},Bo=function(){return{code:353,indent:0,parameters:[]}},jo=function(){return{code:354,indent:0,parameters:[]}},Wo=function(e,r,i,p){return{code:133,indent:0,parameters:[{name:e,volume:r,pitch:i,pan:p}]}},Go=function(e,r,i,p){return{code:139,indent:0,parameters:[{name:e,volume:r,pitch:i,pan:p}]}},xo=function(e,r,i,p,h){return{code:140,indent:0,parameters:[e,{name:r,volume:i,pitch:p,pan:h}]}},qo=function(e){return{code:134,indent:0,parameters:[e]}},Uo=function(e){return{code:135,indent:0,parameters:[e]}},zo=function(e){return{code:136,indent:0,parameters:[e]}},Jo=function(e){return{code:137,indent:0,parameters:[e]}},Xo=function(e,r,i){return{code:138,indent:0,parameters:[[e,r,i,0]]}},Yo=function(e,r,i,p,h,g){return{code:322,indent:0,parameters:[e,r,i,p,h,g]}},Ko=function(e,r,i){return{code:323,indent:0,parameters:[e,r,i]}},Zo=function(e){return{code:281,indent:0,parameters:[e]}},Qo=function(e){return{code:282,indent:0,parameters:[e]}},ei=function(e,r){return{code:283,indent:0,parameters:[e,r]}},ti=function(e,r,i,p,h){return{code:284,indent:0,parameters:[e,r,i,p,h]}},ni=function(e,r,i,p,h){return{code:285,indent:0,parameters:[e,r,i,p,h]}},si=function(e,r,i,p,h){return{code:331,indent:0,parameters:[e,r,i,p,h]}},ri=function(e,r,i,p){return{code:332,indent:0,parameters:[e,r,i,p]}},ai=function(e,r,i,p){return{code:342,indent:0,parameters:[e,r,i,p]}},oi=function(e,r,i){return{code:333,indent:0,parameters:[e,r,i]}},ii=function(e){return{code:334,indent:0,parameters:[e]}},ci=function(e){return{code:335,indent:0,parameters:[e]}},ui=function(e,r){return{code:336,indent:0,parameters:[e,r]}},li=function(e,r,i){return{code:337,indent:0,parameters:[e,r,i]}},mi=function(e,r,i,p){return{code:339,indent:0,parameters:[e,r,i,p]}},pi=function(){return{code:340,indent:0,parameters:[]}},hi=function(e){const C=e.reduce((d,I)=>{const A=I.code;return A===111?d.push(111):A===411?d.push(411):A===0&&d.pop(),d},[]).reduce((d,I)=>(d.push(Se()),I===111||I===411?d.push(He()):I===112&&d.push(Pt()),d),[]);return e.concat(C)},di=function(e,r,i,p){const h=e.match(/<face *: *(.+?)>/i)||e.match(/<FC *: *(.+?)>/i)||e.match(/<顔 *: *(.+?)>/i),g=e.match(/<windowposition *: *(.+?)>/i)||e.match(/<WP *: *(.+?)>/i)||e.match(/<位置 *: *(.+?)>/i),C=e.match(/<background *: *(.+?)>/i)||e.match(/<BG *: *(.+?)>/i)||e.match(/<背景 *: *(.+?)>/i),d=e.match(/<name *: ?(.+?)>/i)||e.match(/<NM *: ?(.+?)>/i)||e.match(/<名前 *: ?(.+?)>/i),I=e.match(/<plugincommand *: *(.+?)>/i)||e.match(/<PC *: *(.+?)>/i)||e.match(/<プラグインコマンド *: *(.+?)>/i),A=e.match(/<plugincommandmz\s*:\s*([^\s].*)>/i)||e.match(/<PCZ\s*:\s*([^\s].*)>/i)||e.match(/<プラグインコマンドmz\s*:\s*([^\s].*)>/i),D=e.match(/<commonevent *: *(.+?)>/i)||e.match(/<CE *: *(.+?)>/i)||e.match(/<コモンイベント *: *(.+?)>/i),P=e.match(/<wait *: *(.+?)>/i)||e.match(/<ウェイト *: *(.+?)>/i),j=e.match(/<fadein>/i)||e.match(/<FI>/i)||e.match(/<フェードイン>/i),J=e.match(/<fadeout>/i)||e.match(/<FO>/i)||e.match(/<フェードアウト>/i),B=e.match(/<playbgm *: *([^ ].+)>/i)||e.match(/<BGMの演奏 *: *([^ ].+)>/),K=e.match(/<stopbgm>/i)||e.match(/<playbgm *: *none>/i)||e.match(/<playbgm *: *なし>/i)||e.match(/<BGMの停止>/),Ie=e.match(/<fadeoutbgm *: *(.+?)>/i)||e.match(/<BGMのフェードアウト *: *(.+?)>/),ot=e.match(/<savebgm>/i)||e.match(/<BGMの保存>/),it=e.match(/<replaybgm>/i)||e.match(/<BGMの再開>/),Le=e.match(/<changebattlebgm *: *([^ ].+)>/i)||e.match(/<戦闘曲の変更 *: *([^ ].+)>/),Te=e.match(/<playbgs *: *([^ ].+)>/i)||e.match(/<BGSの演奏 *: *([^ ].+)>/),ct=e.match(/<stopbgs>/i)||e.match(/<playbgs *: *none>/i)||e.match(/<playbgs *: *なし>/i)||e.match(/<BGSの停止>/),Fe=e.match(/<fadeoutbgs *: *(.+?)>/i)||e.match(/<BGSのフェードアウト *: *(.+?)>/),ve=e.match(/<playse *: *([^ ].+)>/i)||e.match(/<SEの演奏 *: *([^ ].+)>/),ut=e.match(/<stopse>/i)||e.match(/<SEの停止>/),T=e.match(/<playme *: *([^ ].+)>/i)||e.match(/<MEの演奏 *: *([^ ].+)>/),W=e.match(/<stopme>/i)||e.match(/<playme *: *none>/i)||e.match(/<playme *: *なし>/i)||e.match(/<MEの停止>/),re=e.match(/<showpicture\s*:\s*([^\s].*)>/i)||e.match(/<ピクチャの表示\s*:\s*([^\s].+)>/i)||e.match(/<SP\s*:\s*([^\s].+)>/i),Re=e.match(/<movepicture\s*:\s*([^\s].*)>/i)||e.match(/<ピクチャの移動\s*:\s*([^\s].*)>/i)||e.match(/<MP\s*:\s*([^\s].*)>/i),lt=e.match(/<rotatepicture\s*:\s*(\d{1,2})\s*,\s*(-?\d{1,2})\s*>/i)||e.match(/<ピクチャの回転\s*:\s*(\d{1,2})\s*,\s*(-?\d{1,2})\s*>/i)||e.match(/<RP\s*:\s*(\d{1,2})\s*,\s*(-?\d{1,2})\s*>/i),Bt=e.match(/<tintpicture\s*:\s*([^\s].*)>/i)||e.match(/<ピクチャの色調変更\s*:\s*([^\s].*)>/i)||e.match(/<TP\s*:\s*([^\s].*)>/i),jt=e.match(/<erasepicture\s*:\s*(\d{1,2})\s*>/i)||e.match(/<ピクチャの消去\s*:\s*(\d{1,2})\s*>/i)||e.match(/<ep\s*:\s*(\d{1,2})\s*>/i),Wt=e.match(/\s*<if\s*:\s*([^\s].*)>/i)||e.match(/\s*<条件分岐\s*:\s*([^\s].*)>/i),wi=e.match(/\s*<else>/i)||e.match(/\s*<それ以外のとき>/),bi=e.match(/\s*<end>/i)||e.match(/\s*<分岐終了>/),Ci=e.match(/\s*<loop>/i)||e.match(/\s*<ループ>/),Ei=e.match(/<repeatabove>/i)||e.match(/\s*<以上繰り返し>/)||e.match(/\s*<ra>/i),vi=e.match(/<breakloop>/i)||e.match(/<ループの中断>/)||e.match(/<BL>/i),Oi=e.match(/<ExitEventProcessing>/i)||e.match(/<イベント処理の中断>/)||e.match(/<EEP>/i),Gt=e.match(/<label\s*:\s*(\S+)\s*>/i)||e.match(/<ラベル\s*:\s*(\S+)\s*>/i),xt=e.match(/<jumptolabel\s*:\s*(\S+)\s*>/i)||e.match(/<ラベルジャンプ\s*:\s*(\S+)\s*>/)||e.match(/<jtl\s*:\s*(\S+)\s*>/i),mt=e.match(/<InputNumber\s*:\s*(\d+),\s*(\d+)>/i)||e.match(/<INN\s*:\s*(\d+),\s*(\d+)>/i)||e.match(/<数値入力の処理\s*:\s*(\d+),\s*(\d+)>/i),pt=e.match(/<SelectItem\s*:\s*(\d+),\s*([\s\S]+)\s*>/i)||e.match(/<SI\s*:\s*(\d+),\s*([\s\S]+)\s*>/i)||e.match(/<アイテム選択の処理\s*:\s*(\d+),\s*([\s\S]+)\s*>/i),qt=e.match(/<ShowChoices\s*:*\s*([\s\S]*)>/i)||e.match(/<SHC\s*:*\s*([\s\S]*)>/i)||e.match(/<選択肢の表示\s*:*\s*([\s\S]*)>/i),Ut=e.match(/<When\s*:\s*([\s\S]+)>/i)||e.match(/<選択肢\s*:\s*([\s\S]+)>/i),yi=e.match(/<WhenCancel>/i)||e.match(/<キャンセルのとき>/i),zt=e.match(/<ChangeGold\s*:\s*([^\s].*)>/i)||e.match(/<所持金の増減\s*:\s*([^\s].*)>/i),Jt=e.match(/<ChangeItems\s*:\s*([^\s].*)>/i)||e.match(/<アイテムの増減\s*:\s*([^\s].*)>/i),Xt=e.match(/<ChangeWeapons\s*:\s*([^\s].*)>/i)||e.match(/<武器の増減\s*:\s*([^\s].*)>/i),Yt=e.match(/<ChangeArmors\s*:\s*([^\s].*)>/i)||e.match(/<防具の増減\s*:\s*([^\s].*)>/i),Kt=e.match(/<ChangePartyMember\s*:\s*([^\s].*)>/i)||e.match(/<メンバーの入れ替え\s*:\s*([^\s].*)>/i),Zt=e.match(/<ChangeHp\s*:\s*([^\s].*)>/i)||e.match(/<HPの増減\s*:\s*([^\s].*)>/i),Qt=e.match(/<ChangeMp\s*:\s*([^\s].*)>/i)||e.match(/<MPの増減\s*:\s*([^\s].*)>/i),en=e.match(/<ChangeTp\s*:\s*([^\s].*)>/i)||e.match(/<TPの増減\s*:\s*([^\s].*)>/i),tn=e.match(/<ChangeState\s*:\s*([^\s].*)>/i)||e.match(/<ステートの変更\s*:\s*([^\s].*)>/i),nn=e.match(/<RecoverAll\s*:\s*([^\s].*)>/i)||e.match(/<全回復\s*:\s*([^\s].*)>/i),sn=e.match(/<ChangeExp\s*:\s*([^\s].*)>/i)||e.match(/<経験値の増減\s*:\s*([^\s].*)>/i),rn=e.match(/<ChangeLevel\s*:\s*([^\s].*)>/i)||e.match(/<レベルの増減\s*:\s*([^\s].*)>/i),an=e.match(/<ChangeParameter\s*:\s*([^\s].*)>/i)||e.match(/<能力値の増減\s*:\s*([^\s].*)>/i),on=e.match(/<ChangeSkill\s*:\s*([^\s].*)>/i)||e.match(/<スキルの増減\s*:\s*([^\s].*)>/i),cn=e.match(/<ChangeEquipment\s*:\s*([^\s].*)>/i)||e.match(/<装備の変更\s*:\s*([^\s].*)>/i),un=e.match(/<ChangeName\s*:\s*([^\s].*)>/i)||e.match(/<名前の変更\s*:\s*([^\s].*)>/i),ln=e.match(/<ChangeClass\s*:\s*([^\s].*)>/i)||e.match(/<職業の変更\s*:\s*([^\s].*)>/i),mn=e.match(/<ChangeNickname\s*:\s*([^\s].*)>/i)||e.match(/<二つ名の変更\s*:\s*([^\s].*)>/i),pn=e.match(/<ChangeProfile\s*:\s*([^\s].*)>/i)||e.match(/<プロフィールの変更\s*:\s*([^\s].*)>/i),hn=e.match(/<TransferPlayer\s*:\s*([^\s].*)>/i)||e.match(/<場所移動\s*:\s*([^\s].*)>/i),dn=e.match(/<SetVehicleLocation\s*:\s*([^\s].*)>/i)||e.match(/<乗り物の位置設定\s*:\s*([^\s].*)>/i),fn=e.match(/<SetEventLocation\s*:\s*([^\s].*)>/i)||e.match(/<イベントの位置設定\s*:\s*([^\s].*)>/i),gn=e.match(/<ScrollMap\s*:\s*([^\s].*)>/i)||e.match(/<マップのスクロール\s*:\s*([^\s].*)>/i),_n=e.match(/<SetMovementRoute\s*:\s*([^\s].*)>/i)||e.match(/<移動ルートの設定\s*:\s*([^\s].*)>/i),Si=e.match(/<MoveDown>/i)||e.match(/<下に移動>/),Ii=e.match(/<MoveLeft>/i)||e.match(/<左に移動>/),Li=e.match(/<MoveRight>/i)||e.match(/<右に移動>/),Ti=e.match(/<MoveUp>/i)||e.match(/<上に移動>/),Fi=e.match(/<MoveLowerLeft>/i)||e.match(/<左下に移動>/),Ai=e.match(/<MoveLowerRight>/i)||e.match(/<右下に移動>/),Ni=e.match(/<MoveUpperLeft>/i)||e.match(/<左上に移動>/),Mi=e.match(/<MoveUpperRight>/i)||e.match(/<右上に移動>/),Di=e.match(/<MoveAtRandom>/i)||e.match(/<ランダムに移動>/),ki=e.match(/<MoveTowardPlayer>/i)||e.match(/<プレイヤーに近づく>/),Pi=e.match(/<MoveAwayFromPlayer>/i)||e.match(/<プレイヤーから遠ざかる>/),$i=e.match(/<OneStepForward>/i)||e.match(/<一歩前進>/),Vi=e.match(/<OneStepBackward>/i)||e.match(/<一歩後退>/),wn=e.match(/<Jump\s*:\s*([^\s].*)>/i)||e.match(/<ジャンプ\s*:\s*([^\s].*)>/i),bn=e.match(/<McWait\s*:\s*([^\s].*)>/i)||e.match(/<移動コマンドウェイト\s*:\s*([^\s].*)>/i),Hi=e.match(/<TurnDown>/i)||e.match(/<下を向く>/),Ri=e.match(/<TurnLeft>/i)||e.match(/<左を向く>/),Bi=e.match(/<TurnRight>/i)||e.match(/<右を向く>/),ji=e.match(/<TurnUp>/i)||e.match(/<上を向く>/),Wi=e.match(/<Turn90Right>/i)||e.match(/<右に90度回転>/),Gi=e.match(/<Turn90Left>/i)||e.match(/<左に90度回転>/),xi=e.match(/<Turn180>/i)||e.match(/<180度回転>/),qi=e.match(/<Turn90RightorLeft>/i)||e.match(/<右か左に90度回転>/),Ui=e.match(/<TurnAtRandom>/i)||e.match(/<ランダムに方向転換>/),zi=e.match(/<TurnTowardPlayer>/i)||e.match(/<プレイヤーの方を向く>/),Ji=e.match(/<TurnAwayFromPlayer>/i)||e.match(/<プレイヤーの逆を向く>/),Cn=e.match(/<SwitchOn\s*:\s*([^\s].*)>/i)||e.match(/<スイッチON\s*:\s*([^\s].*)>/i),En=e.match(/<SwitchOff\s*:\s*([^\s].*)>/i)||e.match(/<スイッチOFF\s*:\s*([^\s].*)>/i),vn=e.match(/<ChangeSpeed\s*:\s*([^\s].*)>/i)||e.match(/<移動速度の変更\s*:\s*([^\s].*)>/i),On=e.match(/<ChangeFrequency\s*:\s*([^\s].*)>/i)||e.match(/<移動頻度の変更\s*:\s*([^\s].*)>/i),Xi=e.match(/<WalkingAnimationOn>/i)||e.match(/<歩行アニメON>/),Yi=e.match(/<WalkingAnimationOff>/i)||e.match(/<歩行アニメOFF>/),Ki=e.match(/<SteppingAnimationOn>/i)||e.match(/<足踏みアニメON>/),Zi=e.match(/<SteppingAnimationOff>/i)||e.match(/<足踏みアニメOFF>/),Qi=e.match(/<DirectionFixOn>/i)||e.match(/<向き固定ON>/),ec=e.match(/<DirectionFixOff>/i)||e.match(/<向き固定OFF>/),tc=e.match(/<ThroughOn>/i)||e.match(/<すり抜けON>/),nc=e.match(/<ThroughOff>/i)||e.match(/<すり抜けOFF>/),sc=e.match(/<TransparentOn>/i)||e.match(/<透明化ON>/),rc=e.match(/<TransparentOff>/i)||e.match(/<透明化OFF>/),yn=e.match(/<ChangeImage\s*:\s*([^\s].*)>/i)||e.match(/<画像の変更\s*:\s*([^\s].*)>/i),Sn=e.match(/<ChangeOpacity\s*:\s*([^\s].*)>/i)||e.match(/<不透明度の変更\s*:\s*([^\s].*)>/i),In=e.match(/<ChangeBlendMode\s*:\s*([^\s].*)>/i)||e.match(/<合成方法の変更\s*:\s*([^\s].*)>/i),ht=e.match(/<McPlaySe *: *([^ ].+)>/i)||e.match(/<移動コマンドSEの演奏 *: *([^ ].+)>/),Ln=e.match(/<McScript\s*:\s*([^\s].*)>/i)||e.match(/<移動コマンドスクリプト\s*:\s*([^\s].*)>/i),ac=e.match(/<GetOnOffVehicle>/i)||e.match(/<乗り物の乗降>/),Tn=e.match(/<ChangeTransparency\s*:\s*([^\s].*)>/i)||e.match(/<透明状態の変更\s*:\s*([^\s].*)>/i),Fn=e.match(/<ChangePlayerFollowers\s*:\s*([^\s].*)>/i)||e.match(/<隊列歩行の変更\s*:\s*([^\s].*)>/i),oc=e.match(/<GatherFollowers>/i)||e.match(/<隊列メンバーの集合>/),An=e.match(/<ShowAnimation\s*:\s*([^\s].*)>/i)||e.match(/<アニメーションの表示\s*:\s*([^\s].*)>/i),Nn=e.match(/<ShowBalloonIcon\s*:\s*([^\s].*)>/i)||e.match(/<フキダシアイコンの表示\s*:\s*([^\s].*)>/i),ic=e.match(/<EraseEvent>/i)||e.match(/<イベントの一時消去>/),Mn=e.match(/<TintScreen\s*:?\s*([^\s]*.*)>/i)||e.match(/<画面の色調変更\s*:?\s*([^\s]*.*)>/i),Dn=e.match(/<FlashScreen\s*:\s*([^\s].*)>/i)||e.match(/<画面のフラッシュ\s*:\s*([^\s].*)>/i),kn=e.match(/<ShakeScreen\s*:\s*([^\s].*)>/i)||e.match(/<画面のシェイク\s*:\s*([^\s].*)>/i),Pn=e.match(/<SetWeatherEffect\s*:\s*([^\s].*)>/i)||e.match(/<天候の設定\s*:\s*([^\s].*)>/i),$n=e.match(/<PlayMovie\s*:\s*([^\s].*)>/i)||e.match(/<ムービーの再生\s*:\s*([^\s].*)>/i),Vn=e.match(/<BattleProcessing\s*:\s*([^\s].*)>/i)||e.match(/<戦闘の処理\s*:\s*([^\s].*)>/i),Hn=e.match(/<ShopProcessing\s*:*\s*([\s\S]*)>/i)||e.match(/<ショップの処理\s*:\s*([^\s].*)>/i),Rn=e.match(/<Merchandise\s*:\s*([^\s].*)>/i)||e.match(/<商品\s*:\s*([^\s].*)>/i),cc=e.match(/\s*<IfWin>/i)||e.match(/\s*<勝ったとき>/),uc=e.match(/\s*<IfEscape>/i)||e.match(/\s*<逃げたとき>/),lc=e.match(/\s*<IfLose>/i)||e.match(/\s*<負けたとき>/),Bn=e.match(/<NameInputProcessing\s*:\s*([^\s].*)>/i)||e.match(/<名前入力の処理\s*:\s*([^\s].*)>/i),mc=e.match(/<OpenMenuScreen>/i)||e.match(/<メニュー画面を開く>/),pc=e.match(/<OpenSaveScreen>/i)||e.match(/<セーブ画面を開く>/),hc=e.match(/<GameOver>/i)||e.match(/<ゲームオーバー>/),dc=e.match(/<ReturnToTitleScreen>/i)||e.match(/<タイトル画面に戻す>/),jn=e.match(/<ChangeVictoryMe\s*:\s*([^\s].*)>/i)||e.match(/<勝利MEの変更\s*:\s*([^\s].*)>/i),Wn=e.match(/<ChangeDefeatMe\s*:\s*([^\s].*)>/i)||e.match(/<敗北MEの変更\s*:\s*([^\s].*)>/i),Gn=e.match(/<ChangeVehicleBgm\s*:\s*([^\s].*)>/i)||e.match(/<乗り物BGMの変更\s*:\s*([^\s].*)>/i),xn=e.match(/<ChangeSaveAccess\s*:\s*([^\s].*)>/i)||e.match(/<セーブ禁止の変更\s*:\s*([^\s].*)>/i),qn=e.match(/<ChangeMenuAccess\s*:\s*([^\s].*)>/i)||e.match(/<メニュー禁止の変更\s*:\s*([^\s].*)>/i),Un=e.match(/<ChangeEncounter\s*:\s*([^\s].*)>/i)||e.match(/<エンカウント禁止の変更\s*:\s*([^\s].*)>/i),zn=e.match(/<ChangeFormationAccess\s*:\s*([^\s].*)>/i)||e.match(/<並び変え禁止の変更\s*:\s*([^\s].*)>/i),Jn=e.match(/<ChangeWindowColor\s*:\s*([^\s].*)>/i)||e.match(/<ウィンドウカラーの変更\s*:\s*([^\s].*)>/i),Xn=e.match(/<ChangeActorImages\s*:\s*([^\s].*)>/i)||e.match(/<アクターの画像変更\s*:\s*([^\s].*)>/i),Yn=e.match(/<ChangeVehicleImage\s*:\s*([^\s].*)>/i)||e.match(/<乗り物の画像変更\s*:\s*([^\s].*)>/i),Kn=e.match(/<ChangeMapNameDisplay\s*:\s*([^\s].*)>/i)||e.match(/<マップ名表示の変更\s*:\s*([^\s].*)>/i),Zn=e.match(/<ChangeTileset\s*:\s*([^\s].*)>/i)||e.match(/<タイルセットの変更\s*:\s*([^\s].*)>/i),Qn=e.match(/<ChangeBattleBackGround\s*:\s*([^\s].*)>/i)||e.match(/<戦闘背景の変更\s*:\s*([^\s].*)>/i),es=e.match(/<ChangeParallax\s*:\s*([^\s].*)>/i)||e.match(/<遠景の変更\s*:\s*([^\s].*)>/i),ts=e.match(/<GetLocationInfo\s*:\s*([^\s].*)>/i)||e.match(/<指定位置の情報取得\s*:\s*([^\s].*)>/i),ns=e.match(/<ChangeEnemyHp\s*:\s*([^\s].*)>/i)||e.match(/<敵キャラのHP増減\s*:\s*([^\s].*)>/i),ss=e.match(/<ChangeEnemyMp\s*:\s*([^\s].*)>/i)||e.match(/<敵キャラのMP増減\s*:\s*([^\s].*)>/i),rs=e.match(/<ChangeEnemyTp\s*:\s*([^\s].*)>/i)||e.match(/<敵キャラのTP増減\s*:\s*([^\s].*)>/i),as=e.match(/<ChangeEnemyState\s*:\s*([^\s].*)>/i)||e.match(/<敵キャラのステート変更\s*:\s*([^\s].*)>/i),os=e.match(/<EnemyRecoverAll\s*:\s*([^\s].*)>/i)||e.match(/<敵キャラの全回復\s*:\s*([^\s].*)>/i),is=e.match(/<EnemyAppear\s*:\s*([^\s].*)>/i)||e.match(/<敵キャラの出現\s*:\s*([^\s].*)>/i),cs=e.match(/<EnemyTransform\s*:\s*([^\s].*)>/i)||e.match(/<敵キャラの変身\s*:\s*([^\s].*)>/i),us=e.match(/<ShowBattleAnimation\s*:\s*([^\s].*)>/i)||e.match(/<戦闘アニメーションの表示\s*:\s*([^\s].*)>/i),ls=e.match(/<ForceAction\s*:\s*([^\s].*)>/i)||e.match(/<戦闘行動の強制\s*:\s*([^\s].*)>/i),fc=e.match(/<AbortBattle>/i)||e.match(/<バトルの中断>/),ms=e.match(/#SCRIPT_BLOCK[0-9]+#/i),ps=e.match(/#COMMENT_BLOCK[0-9]+#/i),hs=e.match(/#SCROLLING_BLOCK[0-9]+#/i);if(ms){const t=ms[0];return p[t]}if(ps){const t=ps[0];return p[t]}if(hs){const t=hs[0];return p[t]}if(I)return[or(I[1])];if(A){const t=A[1].split(",").map(u=>u.trim()),o=[];if(t.length>2){const u=t[0],m=t[1],f=t[2],w=t.slice(3),E=ir(u,m,f,w);o.push(E),w.map(F=>o.push(cr(F)))}else throw new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "));return o}if(D){const t=Number(D[1]);if(t)return[ur(t)];throw new Error("Syntax error. / 文法エラーです。"+D[1]+" is not number. / "+D[1]+"は整数ではありません")}if(P){const t=Number(P[1]);if(t)return[dr(t)];throw new Error("Syntax error. / 文法エラーです。"+D[1]+" is not number. / "+D[1]+"は整数ではありません")}if(j)return[fr()];if(J)return[gr()];if(K)return[_r(90,100,0)];if(B&&B[1]){const t=B[1].replace(/ /g,"").split(",");let o="Battle1",u=90,m=100,f=0;return t[0]&&(o=t[0]),(Number(t[1])||Number(t[1])===0)&&(u=Number(t[1])),(Number(t[2])||Number(t[2])===0)&&(m=Number(t[2])),(Number(t[3])||Number(t[3])===0)&&(f=Number(t[3])),o.toUpperCase()==="NONE"||o==="なし"?[tt("",u,m,f)]:[tt(o,u,m,f)]}if(Ie&&Ie[1]){let t=10;const o=Ie[1].replace(/ /g,"");return(Number(o)||Number(o)===0)&&(t=Number(o)),[wr(t)]}if(ot)return[br()];if(it)return[Cr()];if(Le&&Le[1]){const t=Le[1].replace(/ /g,"").split(",");let o="Battle1",u=90,m=100,f=0;return t[0]&&(o=t[0]),(Number(t[1])||Number(t[1])===0)&&(u=Number(t[1])),(Number(t[2])||Number(t[2])===0)&&(m=Number(t[2])),(Number(t[3])||Number(t[3])===0)&&(f=Number(t[3])),o.toUpperCase()==="NONE"||o==="なし"?[Mt("",u,m,f)]:[Mt(o,u,m,f)]}if(ct)return[Er(90,100,0)];if(Te&&Te[1]){const t=Te[1].replace(/ /g,"").split(",");let o="City",u=90,m=100,f=0;return t[0]&&(o=t[0]),(Number(t[1])||Number(t[1])===0)&&(u=Number(t[1])),(Number(t[2])||Number(t[2])===0)&&(m=Number(t[2])),(Number(t[3])||Number(t[3])===0)&&(f=Number(t[3])),o.toUpperCase()==="NONE"||o==="なし"?[nt("",u,m,f)]:[nt(o,u,m,f)]}if(Fe&&Fe[1]){let t=10;const o=Fe[1].replace(/ /g,"");return(Number(o)||Number(o)===0)&&(t=Number(o)),[vr(t)]}if(ve&&ve[1]){const t=ve[1].replace(/ /g,"").split(",");let o="Attack1",u=90,m=100,f=0;return t[0]&&(o=t[0]),(Number(t[1])||Number(t[1])===0)&&(u=Number(t[1])),(Number(t[2])||Number(t[2])===0)&&(m=Number(t[2])),(Number(t[3])||Number(t[3])===0)&&(f=Number(t[3])),o.toUpperCase()==="NONE"||o==="なし"?[Dt("",u,m,f)]:[Dt(o,u,m,f)]}if(ut)return[Or()];if(W)return[yr(90,100,0)];if(T&&T[1]){const t=T[1].replace(/ /g,"").split(",");let o="Curse1",u=90,m=100,f=0;return t[0]&&(o=t[0]),(Number(t[1])||Number(t[1])===0)&&(u=Number(t[1])),(Number(t[2])||Number(t[2])===0)&&(m=Number(t[2])),(Number(t[3])||Number(t[3])===0)&&(f=Number(t[3])),o.toUpperCase()==="NONE"||o==="なし"?[st("",u,m,f)]:[st(o,u,m,f)]}const ae="\\w゠-ヿ぀-ゟ々-〆ム-鿏",Z=".+",gc=["set","代入","="].map(t=>`<${t} *: *(\\d+\\-?\\d*) *, *(${Z}) *>`),ce=e.match(new RegExp(gc.join("|"),"i")),_c=["add","加算","\\+"].map(t=>`<${t} *: *(\\d+\\-?\\d*) *, *(${Z}) *>`),ue=e.match(new RegExp(_c.join("|"),"i")),wc=["sub","減算","-"].map(t=>`<${t} *: *(\\d+\\-?\\d*) *, *(${Z}) *>`),le=e.match(new RegExp(wc.join("|"),"i")),bc=["mul","乗算","\\*"].map(t=>`<${t} *: *(\\d+\\-?\\d*) *, *(${Z}) *>`),me=e.match(new RegExp(bc.join("|"),"i")),Cc=["div","除算","\\/"].map(t=>`<${t} *: *(\\d+\\-?\\d*) *, *(${Z}) *>`),pe=e.match(new RegExp(Cc.join("|"),"i")),Ec=["mod","剰余","\\%"].map(t=>`<${t} *: *(\\d+\\-?\\d*) *, *(${Z}) *>`),he=e.match(new RegExp(Ec.join("|"),"i")),vc=["sw","switch","スイッチ"].map(t=>`<${t} *: *(\\d+\\-?\\d*) *, *(${Z}) *>`),de=e.match(new RegExp(vc.join("|"),"i")),Oc=["ssw","selfswitch","セルフスイッチ"].map(t=>`<${t} *: *([abcd]) *, *(${Z}) *>`),fe=e.match(new RegExp(Oc.join("|"),"i")),oe=function(t,o,u){if(t==="selfswitch"){const $=o.match(/[abcd]/i),we=u.match(/on|オン|1|true|off|オフ|0|false/i);if($&&we)return Ir($[0],we[0])}const m=o.match(/\d+/i),f=o.match(/(\d+)-(\d+)/i);let w=0,E=0;if(f)w=parseInt(f[1]),E=parseInt(f[2]);else if(m){const $=parseInt(m[0]);w=$,E=$}else throw new Error("Syntax error. / 文法エラーです。");if(t==="switch"){const $=u.match(/on|オン|1|true|off|オフ|0|false/i);if($)return Sr(w,E,$[0])}const F=u.match(/v\[(\d+)\]|variables\[(\d+)\]|変数\[(\d+)\]/i);if(F){const $=F[1]||F[2]||F[3];return se(t,w,E,"variables",parseInt($))}const V=u.match(/r\[(\-?\d+)\]\[(\-?\d+)\]|random\[(\-?\d+)\]\[(\-?\d+)\]|乱数\[(\-?\d+)\]\[(\-?\d+)\]/i);if(V){const $=V[1]||V[3]||V[5],we=V[2]||V[4]||V[6];return se(t,w,E,"random",parseInt($),parseInt(we))}const Ml=["gd","gamedata","ゲームデータ"].map($=>`(${$})(${Z})`),Ge=u.match(new RegExp(Ml.join("|"),"i"));if(Ge){const $=Ge[2]||Ge[4]||Ge[6],we=$.match(new RegExp(`\\[([${ae}]+)\\]`,"i"));if(we){const Ne=we[1];switch(Ne.toLowerCase()){case"mapid":case"マップid":case"partymembers":case"パーティ人数":case"gold":case"所持金":case"steps":case"歩数":case"playtime":case"プレイ時間":case"timer":case"タイマー":case"savecount":case"セーブ回数":case"battlecount":case"戦闘回数":case"wincount":case"勝利回数":case"escapecount":case"逃走回数":return se(t,w,E,"gamedata","other",Ne.toLowerCase(),0);case"item":case"アイテム":case"weapon":case"武器":case"armor":case"防具":case"party":case"パーティ":{const ee=$.match(new RegExp(`\\[[${ae}]+\\]\\[([${ae}]+)\\]`,"i"));if(ee){const Me=ee[1];return se(t,w,E,"gamedata",Ne.toLowerCase(),parseInt(Me))}break}case"last":case"直前":{const ee=$.match(new RegExp(`\\[[${ae}]+\\]\\[([${ae} ]+)\\]`,"i"));if(ee){const Me=ee[1];return se(t,w,E,"gamedata",Ne.toLowerCase(),Me)}break}case"actor":case"アクター":case"enemy":case"敵キャラ":case"エネミー":case"character":case"キャラクター":{const ee=$.match(new RegExp(`\\[[${ae}]+\\]\\[([${ae}\\-]+)\\]\\[([${ae}\\.]+)\\]`,"i"));if(ee){const Me=ee[1],kl=ee[2];return se(t,w,E,"gamedata",Ne.toLowerCase(),Me,kl)}break}}}}const xe=u.match(/sc\[(.+)\]|script\[(.+)\]|スクリプト\[(.+)\]/i);if(xe){const $=xe[1]||xe[2]||xe[3];return se(t,w,E,"script",$)}const Dl=Number(u);return se(t,w,E,"constant",Dl)};if(ce){const t=ce[1]||ce[3]||ce[5],o=ce[2]||ce[4]||ce[6];return[oe("set",t,o)]}if(ue){const t=ue[1]||ue[3]||ue[5],o=ue[2]||ue[4]||ue[6];return[oe("add",t,o)]}if(le){const t=le[1]||le[3]||le[5],o=le[2]||le[4]||le[6];return[oe("sub",t,o)]}if(me){const t=me[1]||me[3]||me[5],o=me[2]||me[4]||me[6];return[oe("mul",t,o)]}if(pe){const t=pe[1]||pe[3]||pe[5],o=pe[2]||pe[4]||pe[6];return[oe("div",t,o)]}if(he){const t=he[1]||he[3]||he[5],o=he[2]||he[4]||he[6];return[oe("mod",t,o)]}if(de){const t=de[1]||de[3]||de[5],o=de[2]||de[4]||de[6];return[oe("switch",t,o)]}if(fe){const t=fe[1]||fe[3]||fe[5],o=fe[2]||fe[4]||fe[6];return[oe("selfswitch",t,o)]}const yc=["timer","タイマー"].map(t=>`<${t} *: *(.+) *, *(\\d+), *(\\d+) *>`),ge=e.match(new RegExp(yc.join("|"),"i")),Sc=["timer","タイマー"].map(t=>`<${t} *: *(.+) *>`),dt=e.match(new RegExp(Sc.join("|"),"i"));if(ge){const t=ge[1]||ge[4],o=parseInt(ge[2]||ge[5]),u=parseInt(ge[3]||ge[6]),m=60*o+u;return[kt(t,m)]}if(dt){const t=dt[1]||dt[2];return[kt(t,0)]}if(re){const t=re[1].split(",").map(o=>o.trim());if(t.length>1){const o=Number(t[0]),u=t[1],m=t.slice(2);return[Tr(o,u,m)]}else throw console.error(e),new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "))}if(Re){const t=Re[1].split(",").map(o=>o.trim());if(t.length>0){const o=Number(t[0]),u=t.slice(1);return[Fr(o,u)]}else throw console.error(e),new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "))}if(lt){const t=Number(lt[1]),o=Number(lt[2]);return[Ar(t,o)]}if(Bt){const t=Bt[1].split(",").map(o=>o.trim());if(t.length>0){const o=Number(t[0]),u=t.slice(1);return[Nr(o,u)]}else throw console.error(e),new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "))}if(jt){const t=Number(jt[1]);return[Mr(t)]}if(Wt){const t=Wt[1].split(",");if(t.length>0){const o=t[0].trim(),u=t.slice(1);return[zr(o,u)]}else throw console.error(e),new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "))}if(wi){const t=[];return t.push(Se()),t.push(Jr()),t}if(bi){const t=i.slice(-1)[0],o=102,u=301;return t&&t.code===o?[Ee(),$t()]:t&&t.code===u?[Ee(),Ht()]:[Se(),He()]}if(Ci)return[Xr()];if(Ei){const t=[];return t.push(Se()),t.push(Pt()),t}if(vi)return[Yr()];if(Oi)return[Kr()];if(Gt){const t=Gt[1]||"";return[Zr(t)]}if(xt){const t=xt[1]||"";return[Qr(t)]}if(mt){const t=Number(mt[1]),o=Number(mt[2]);return[ea(t,o)]}if(pt){const t=Number(pt[1]),o=pt[2];return[ta(t,o)]}if(qt){const t=qt[1].split(",").filter(E=>E).map(E=>E.trim());let o=0,u=2,m=0,f=1,w=!1;return t.forEach(E=>{try{o=U(E);return}catch{}try{u=nr(E);return}catch{}switch(E.toLowerCase()){case"branch":case"分岐":f=-2;return;case"disallow":case"禁止":f=-1;return;case"none":case"なし":m=-1,w=!0;return}isNaN(Number(E))||(w?f=Number(E)-1:(m=Number(E)-1,w=!0))}),[na(o,u,m,f)]}if(Ut){const o=Ut[1];return[sa(0,o)]}if(yi)return[ra()];if(h){r||(r=ie());const t=h[1].match(/.*\((.+?)\)/i);if(t)r.parameters[0]=h[1].replace(/\(\d\)/,""),r.parameters[1]=parseInt(t[1]),e=e.replace(h[0],"");else throw console.error(e),new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "))}if(C){r||(r=ie());try{r.parameters[2]=U(C[1])}catch{throw console.error(e),new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "))}e=e.replace(C[0],"")}if(g){r||(r=ie());try{r.parameters[3]=Ce(g[1])}catch{throw console.error(e),new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "))}e=e.replace(g[0],"")}d&&(r||(r=ie()),r.parameters[4]=d[1],e=e.replace(d[0],""));const ft=[];(h||C||g||d)&&r&&(b.log("push: ",r.parameters),ft.push(r));const Be=/^\d+$/,Oe=/(?:variables|v|変数)\[([0-9]+)\]/i,ds=/(?:actors|v|アクター)\[([0-9]+)\]/i,Ic=["increase","+","増やす"],Lc=["decrease","-","減らす"],Tc=["add","+","加える","付加"],Fc=["remove","-","外す","解除"],Ac=["learn","+","覚える"],Nc=["forget","-","忘れる"],fs=["direct","0","直接指定"],gs=["withvariables","変数で指定"],Mc=["exchange","2","交換"],Dc=["random","2","ランダム"],_s=["character","2","キャラクターで指定","キャラクター"],kc=["retain","0","そのまま"],Pc=["down","2","下"],$c=["left","4","左"],Vc=["right","6","右"],Hc=["up","8","上"],Rc=["black","0","黒"],Bc=["white","1","白"],jc=["none","2","なし"],Wc=["boat","0","小型船"],Gc=["ship","1","大型船"],xc=["airship","2","飛行船"],qc=["x8 slower","1","1/8倍速"],Uc=["x4 slower","2","1/4倍速"],zc=["x2 slower","3","1/2倍速"],Jc=["normal","4","標準速"],Xc=["x2 faster","5","2倍速"],Yc=["x4 faster","6","4倍速"],Kc=["terrain tag","0","地形タグ"],Zc=["event id","1","イベントid"],Qc=["layer 1","2","レイヤー１"],eu=["layer 2","3","レイヤー２"],tu=["layer 3","4","レイヤー３"],nu=["layer 4","5","レイヤー４"],su=["region id","6","リージョンid"],ru=["lowest","1","最低"],au=["lower","2","低"],ou=["normal","3","標準"],iu=["higher","4","高"],cu=["highest","5","最高"],uu=["normal","0","通常"],lu=["additive","1","加算"],mu=["multiply","2","乗算"],pu=["screen","3","スクリーン"],hu=["maxhp","0","最大hp"],du=["maxmp","1","最大mp"],fu=["attack","2","攻撃力"],gu=["defense","3","防御力"],_u=["m.attack","4","魔法力"],wu=["m.defense","5","魔法防御"],bu=["agility","6","敏捷性"],Cu=["luck","7","運"],Eu=["none","なし","0"],ws=["player","-1","プレイヤー"],bs=["this event","0","このイベント"],vu=["exclamation","1","びっくり"],Ou=["question","2","はてな"],yu=["music note","3","音符"],Su=["heart","4","ハート"],Iu=["anger","5","怒り"],Lu=["sweat","6","汗"],Tu=["flustration","cobweb","7","くしゃくしゃ"],Fu=["silence","8","沈黙"],Au=["light bulb","9","電球"],Nu=["zzz","10","zzz"],Mu=["user-defined1","11","ユーザー定義1"],Du=["user-defined2","12","ユーザー定義2"],ku=["user-defined3","13","ユーザー定義3"],Pu=["user-defined4","14","ユーザー定義4"],$u=["user-defined5","15","ユーザー定義5"],G=["none","なし"],Vu=["rain","雨"],Hu=["storm","嵐"],Ru=["snow","雪"],Bu=["item","0","アイテム"],ju=["weapon","1","武器"],Wu=["armor","2","防具"],Gu=["standard","0","標準"],xu=["last target","-1","ラストターゲット"],qu=["random","0","ランダム"],Uu=["index 1","1","インデックス１"],zu=["index 2","2","インデックス２"],Ju=["index 3","3","インデックス３"],Xu=["index 4","4","インデックス４"],Yu=["index 5","5","インデックス５"],Ku=["index 6","6","インデックス６"],Zu=["index 7","7","インデックス７"],Qu=["index 8","8","インデックス８"],el=["true","on","オン","1"],tl=["false","off","オフ","0"],nl=["wait for completion","完了までウェイト","wait"],sl=["purchase only","購入のみ"],rl=["repeat","repeat movements","動作を繰り返す"],al=["skip","skip if cannot move","移動できない場合は飛ばす"],ol=["include equipment","装備品を含む"],il=["initialize","初期化"],cl=["allow knockout","戦闘不能を許可"],ul=["show level up","レベルアップを表示"],ll=["save exp","経験値の保存","save level","レベルの保存"],Cs=["loophorizontally","横方向にループする"],Es=["loopvertically","縦方向にループする"],ml=["true","on","オン","0"],pl=["false","off","オフ","1"],hl=["disable","0","禁止"],dl=["enable","1","許可"],vs=["entire troop","敵グループ全体"],fl=["entire party","パーティ全体"],x=t=>{if(Ic.includes(t))return 0;if(Lc.includes(t))return 1;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},gt=t=>{if(Tc.includes(t))return 0;if(Fc.includes(t))return 1;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},gl=t=>{if(Ac.includes(t))return 0;if(Nc.includes(t))return 1;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},q=t=>{if(t.match(Be))return{operand:0,operandValue:Number(t)};if(t.match(Oe))return{operand:1,operandValue:Number(t.match(Oe)[1])};throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Q=t=>{if(t.match(Be))return{actor:0,actorValue:Number(t)};if(fl.includes(t))return{actor:0,actorValue:0};if(t.match(Oe))return{actor:1,actorValue:Number(t.match(Oe)[1])};throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},_l=t=>{if(t.match(Be))return{subject:0,subjectValue:Number(t)-1};if(t.match(ds))return{subject:1,subjectValue:Number(t.match(ds)[1])};throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},H=t=>{if(el.includes(t))return!0;if(nl.includes(t))return!0;if(sl.includes(t))return!0;if(rl.includes(t))return!0;if(al.includes(t))return!0;if(ol.includes(t))return!0;if(il.includes(t))return!0;if(cl.includes(t))return!0;if(ul.includes(t))return!0;if(ll.includes(t))return!0;if(tl.includes(t))return!1;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},_t=t=>{if(ml.includes(t))return 0;if(pl.includes(t))return 1;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},je=t=>{if(hl.includes(t))return 0;if(dl.includes(t))return 1;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},wt=t=>{if(fs.includes(t))return 0;if(gs.includes(t))return 1;if(Mc.includes(t)||_s.includes(t))return 2;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},wl=(t,o,u)=>{if(fs.includes(t))return{locationType:0,locationX:parseInt(o),locationY:parseInt(u)};if(gs.includes(t))return{locationType:1,locationX:parseInt(o),locationY:parseInt(u)};if(_s.includes(t)){if(ws.includes(o))return{locationType:2,locationX:-1,locationY:0};if(bs.includes(o))return{locationType:2,locationX:0,locationY:0};if(isNaN(parseInt(o)))throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "));return{locationType:2,locationX:parseInt(o),locationY:0}}else throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},bl=t=>{if(t.match(Be))return{troop:0,troopValue:Number(t)};if(t.match(Oe))return{troop:1,troopValue:Number(t.match(Oe)[1])};if(Dc.includes(t))return{troop:2,troopValue:0};throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},bt=t=>{if(kc.includes(t))return 0;if(Pc.includes(t))return 2;if($c.includes(t))return 4;if(Vc.includes(t))return 6;if(Hc.includes(t))return 8;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Cl=t=>{if(Rc.includes(t))return 0;if(Bc.includes(t))return 1;if(jc.includes(t))return 2;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Ct=t=>{if(Wc.includes(t))return 0;if(Gc.includes(t))return 1;if(xc.includes(t))return 2;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Os=t=>{if(qc.includes(t))return 1;if(Uc.includes(t))return 2;if(zc.includes(t))return 3;if(Jc.includes(t))return 4;if(Xc.includes(t))return 5;if(Yc.includes(t))return 6;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},El=t=>{if(ru.includes(t))return 1;if(au.includes(t))return 2;if(ou.includes(t))return 3;if(iu.includes(t))return 4;if(cu.includes(t))return 5;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},vl=t=>{if(uu.includes(t))return 0;if(lu.includes(t))return 1;if(mu.includes(t))return 2;if(pu.includes(t))return 3;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Ol=t=>{if(Kc.includes(t))return 0;if(Zc.includes(t))return 1;if(Qc.includes(t))return 2;if(eu.includes(t))return 3;if(tu.includes(t))return 4;if(nu.includes(t))return 5;if(su.includes(t))return 6;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},yl=t=>{if(hu.includes(t))return 0;if(du.includes(t))return 1;if(fu.includes(t))return 2;if(gu.includes(t))return 3;if(_u.includes(t))return 4;if(wu.includes(t))return 5;if(bu.includes(t))return 6;if(Cu.includes(t))return 7;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Sl=t=>{if(Eu.includes(t))return 0;if(isNaN(parseInt(t)))throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "));return parseInt(t)},Ae=t=>{if(ws.includes(t))return-1;if(bs.includes(t))return 0;if(isNaN(parseInt(t)))throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "));return parseInt(t)},Il=t=>{if(vu.includes(t))return 1;if(Ou.includes(t))return 2;if(yu.includes(t))return 3;if(Su.includes(t))return 4;if(Iu.includes(t))return 5;if(Lu.includes(t))return 6;if(Tu.includes(t))return 7;if(Fu.includes(t))return 8;if(Au.includes(t))return 9;if(Nu.includes(t))return 10;if(Mu.includes(t))return 11;if(Du.includes(t))return 12;if(ku.includes(t))return 13;if(Pu.includes(t))return 14;if($u.includes(t))return 15;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Ll=t=>{if(G.includes(t))return"none";if(Vu.includes(t))return"rain";if(Hu.includes(t))return"storm";if(Ru.includes(t))return"snow";throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Tl=t=>{if(Bu.includes(t))return 0;if(ju.includes(t))return 1;if(Wu.includes(t))return 2;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},Fl=t=>{if(Gu.includes(t))return{price:0,priceValue:0};if(isNaN(parseInt(t)))throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "));return{price:1,priceValue:parseInt(t)}},Al=t=>{if(xu.includes(t))return-2;if(qu.includes(t))return-1;if(Uu.includes(t))return 0;if(zu.includes(t))return 1;if(Ju.includes(t))return 2;if(Xu.includes(t))return 3;if(Yu.includes(t))return 4;if(Ku.includes(t))return 5;if(Zu.includes(t))return 6;if(Qu.includes(t))return 7;throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "))},_e=t=>{if(vs.includes(t))return-1;if(isNaN(parseInt(t)))throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "));return parseInt(t)-1},Nl=t=>{if(vs.includes(t))return{enemyValue:0,isAllChecked:!0};if(isNaN(parseInt(t)))throw new Error("Syntax error. / 文法エラーです。:"+e.replace(/</g,"  ").replace(/>/g,"  "));return{enemyValue:parseInt(t)-1,isAllChecked:!1}};if(zt){const t=zt[1].split(",").map(f=>f.trim().toLowerCase()),o=x(t[0].toLowerCase()),{operand:u,operandValue:m}=q(t[1].toLowerCase());return[aa(o,u,m)]}if(Jt){const t=Jt[1].split(",").map(w=>w.trim().toLowerCase()),o=parseInt(t[0]),u=x(t[1]),{operand:m,operandValue:f}=q(t[2]);return[oa(o,u,m,f)]}if(Xt){const t=Xt[1].split(",").map(E=>E.trim().toLowerCase()),o=parseInt(t[0]),u=x(t[1]),{operand:m,operandValue:f}=q(t[2]),w=t[3]===void 0?!1:H(t[3]);return[ia(o,u,m,f,w)]}if(Yt){const t=Yt[1].split(",").map(E=>E.trim().toLowerCase()),o=parseInt(t[0]),u=x(t[1]),{operand:m,operandValue:f}=q(t[2]),w=t[3]===void 0?!1:H(t[3]);return[ca(o,u,m,f,w)]}if(Kt){const t=Kt[1].split(",").map(f=>f.trim().toLowerCase()),o=parseInt(t[0]),u=gt(t[1]),m=t[2]===void 0?!1:H(t[2]);return[ua(o,u,m)]}if(Zt){const t=Zt[1].split(",").map(F=>F.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]),m=x(t[1]),{operand:f,operandValue:w}=q(t[2]),E=t[3]===void 0?!1:H(t[3]);return[la(o,u,m,f,w,E)]}if(Qt){const t=Qt[1].split(",").map(E=>E.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]),m=x(t[1]),{operand:f,operandValue:w}=q(t[2]);return[ma(o,u,m,f,w)]}if(en){const t=en[1].split(",").map(E=>E.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]),m=x(t[1]),{operand:f,operandValue:w}=q(t[2]);return[pa(o,u,m,f,w)]}if(tn){const t=tn[1].split(",").map(w=>w.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]),m=gt(t[1]),f=parseInt(t[2]);return[ha(o,u,m,f)]}if(nn){const t=nn[1].split(",").map(m=>m.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]);return[da(o,u)]}if(sn){const t=sn[1].split(",").map(F=>F.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]),m=x(t[1]),{operand:f,operandValue:w}=q(t[2]),E=t[3]===void 0?!1:H(t[3]);return[fa(o,u,m,f,w,E)]}if(rn){const t=rn[1].split(",").map(F=>F.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]),m=x(t[1]),{operand:f,operandValue:w}=q(t[2]),E=t[3]===void 0?!1:H(t[3]);return[ga(o,u,m,f,w,E)]}if(an){const t=an[1].split(",").map(F=>F.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]),m=yl(t[1]),f=x(t[2]),{operand:w,operandValue:E}=q(t[3]);return[_a(o,u,m,f,w,E)]}if(on){const t=on[1].split(",").map(w=>w.trim().toLowerCase()),{actor:o,actorValue:u}=Q(t[0]),m=gl(t[1]),f=parseInt(t[2]);return[wa(o,u,m,f)]}if(cn){const t=cn[1].split(",").map(f=>f.trim().toLowerCase()),o=parseInt(t[0]),u=parseInt(t[1]),m=Sl(t[2]);return[ba(o,u,m)]}if(un){const t=un[1].split(",").map(m=>m.trim().toLowerCase()),o=parseInt(t[0]),u=t[1]===void 0?"":t[1];return[Ca(o,u)]}if(ln){const t=ln[1].split(",").map(f=>f.trim().toLowerCase()),o=parseInt(t[0]),u=parseInt(t[1]),m=t[2]===void 0?!1:H(t[2]);return[Ea(o,u,m)]}if(mn){const t=mn[1].split(",").map(m=>m.trim().toLowerCase()),o=parseInt(t[0]),u=t[1]===void 0?"":t[1];return[va(o,u)]}if(pn){const t=pn[1].split(",").map(E=>E.trim()),o=parseInt(t[0]),u=t[1]===void 0?"":String(t[1]),m=t[2]===void 0?"":String(t[2]),f=u.includes("\\n");let w="";return f||m===""?w=u:w=u+`
`+m,[Oa(o,w)]}if(hn){const t=hn[1].split(",").map(We=>We.trim().toLowerCase()),o=/(.*?)\[(\d+)]\[(\d+)]\[(\d+)]/,u=t[0].match(o);if(!u)throw new Error("Syntax error. / 文法エラーです。:"+t[0]);const m=wt(u[1]),f=parseInt(u[2]),w=parseInt(u[3]),E=parseInt(u[4]),F=bt(t[1]),V=Cl(t[2]);return[ya(m,f,w,E,F,V)]}if(dn){const t=dn[1].split(",").map(V=>V.trim().toLowerCase()),o=Ct(t[0]),u=/(.*?)\[(\d+)]\[(\d+)]\[(\d+)]/,m=t[1].match(u);if(!m)throw new Error("Syntax error. / 文法エラーです。:"+t[1]);const f=wt(m[1]),w=parseInt(m[2]),E=parseInt(m[3]),F=parseInt(m[4]);return[Sa(o,f,w,E,F)]}if(fn){const t=fn[1].split(",").map(V=>V.trim().toLowerCase()),o=Ae(t[0]),u=/(.*?)\[(.*?)](\[(\d+)])?(\[(\d+)])?/,m=t[1].match(u);if(!m)throw new Error("Syntax error. / 文法エラーです。:"+t[1]);const f=wt(m[1]);let w=0,E=0;f===0||f===1?(w=parseInt(m[2]),E=parseInt(m[4])):f===2&&(w=Ae(m[2]),E=0);const F=bt(t[2]);return[Ia(o,f,w,E,F)]}if(gn){const t=gn[1].split(",").map(w=>w.trim().toLowerCase()),o=bt(t[0]),u=parseInt(t[1]),m=Os(t[2]),f=t[3]===void 0?!1:H(t[3]);return[La(o,u,m,f)]}if(_n){const t=_n[1].split(",").map(w=>w.trim().toLowerCase()),o=Ae(t[0]),u=t[1]===void 0?!1:H(t[1]),m=t[2]===void 0?!1:H(t[2]),f=t[3]===void 0?!1:H(t[3]);return[Ta(o,u,m,f)]}if(Si)return[Fa()];if(Ii)return[Aa()];if(Li)return[Na()];if(Ti)return[Ma()];if(Fi)return[Da()];if(Ai)return[ka()];if(Ni)return[Pa()];if(Mi)return[$a()];if(Di)return[Va()];if(ki)return[Ha()];if(Pi)return[Ra()];if($i)return[Ba()];if(Vi)return[ja()];if(wn){const t=wn[1].split(",").map(m=>m.trim().toLowerCase()),o=parseInt(t[0]),u=parseInt(t[1]);return[Wa(o,u)]}if(bn){const t=bn[1].split(",").map(u=>u.trim().toLowerCase()),o=parseInt(t[0]);return[Ga(o)]}if(Hi)return[xa()];if(Ri)return[qa()];if(Bi)return[Ua()];if(ji)return[za()];if(Gi)return[Xa()];if(Wi)return[Ja()];if(xi)return[Ya()];if(qi)return[Ka()];if(Ui)return[Za()];if(zi)return[Qa()];if(Ji)return[eo()];if(Cn){const t=Cn[1].split(",").map(u=>u.trim().toLowerCase()),o=parseInt(t[0]);return[to(o)]}if(En){const t=En[1].split(",").map(u=>u.trim().toLowerCase()),o=parseInt(t[0]);return[no(o)]}if(vn){const t=vn[1].split(",").map(u=>u.trim().toLowerCase()),o=Os(t[0]);return[so(o)]}if(On){const t=On[1].split(",").map(u=>u.trim().toLowerCase()),o=El(t[0]);return[ro(o)]}if(Xi)return[ao()];if(Yi)return[oo()];if(Ki)return[io()];if(Zi)return[co()];if(Qi)return[uo()];if(ec)return[lo()];if(tc)return[mo()];if(nc)return[po()];if(sc)return[ho()];if(rc)return[fo()];if(yn){const t=yn[1].split(",").map(m=>m.trim()),o=G.includes(t[0].toLowerCase())?"":t[0],u=t[1]===void 0?0:parseInt(t[1]);return[go(o,u)]}if(Sn){const t=Sn[1].split(",").map(u=>u.trim().toLowerCase()),o=parseInt(t[0]);return[_o(o)]}if(In){const t=In[1].split(",").map(u=>u.trim().toLowerCase()),o=vl(t[0]);return[wo(o)]}if(ht&&ht[1]){const t=ht[1].replace(/ /g,"").split(",");let o="Attack1",u=90,m=100,f=0;return t[0]&&(o=t[0]),(Number(t[1])||Number(t[1])===0)&&(u=Number(t[1])),(Number(t[2])||Number(t[2])===0)&&(m=Number(t[2])),(Number(t[3])||Number(t[3])===0)&&(f=Number(t[3])),o.toUpperCase()==="NONE"||o==="なし"?[Vt("",u,m,f)]:[Vt(o,u,m,f)]}if(Ln){const o=Ln[1].split(",").map(u=>u.trim().toLowerCase())[0];return[bo(o)]}if(ac)return[Co()];if(Tn){const t=Tn[1].split(",").map(u=>u.trim().toLowerCase()),o=_t(t[0]);return[Eo(o)]}if(Fn){const t=Fn[1].split(",").map(u=>u.trim().toLowerCase()),o=_t(t[0]);return[vo(o)]}if(oc)return[Oo()];if(An){const t=An[1].split(",").map(f=>f.trim().toLowerCase()),o=Ae(t[0]),u=parseInt(t[1]),m=t[2]===void 0?!1:H(t[2]);return[yo(o,u,m)]}if(Nn){const t=Nn[1].split(",").map(f=>f.trim().toLowerCase()),o=Ae(t[0]),u=Il(t[1]),m=t[2]===void 0?!1:H(t[2]);return[So(o,u,m)]}if(ic)return[Io()];if(Mn){const t=Mn[1].split(",").map(o=>o.trim());if(t.length>0)return[Lo(t)];throw console.error(e),new Error("Syntax error. / 文法エラーです。"+e.replace(/</g,"  ").replace(/>/g,"  "))}if(Dn){const t=Dn[1].split(",").map(F=>F.trim().toLowerCase()),o=parseInt(t[0]),u=parseInt(t[1]),m=parseInt(t[2]),f=parseInt(t[3]),w=parseInt(t[4]),E=t[5]===void 0?!1:H(t[5]);return[To(o,u,m,f,w,E)]}if(kn){const t=kn[1].split(",").map(w=>w.trim().toLowerCase()),o=parseInt(t[0]),u=parseInt(t[1]),m=parseInt(t[2]),f=t[3]===void 0?!1:H(t[3]);return[Fo(o,u,m,f)]}if(Pn){const t=Pn[1].split(",").map(w=>w.trim().toLowerCase()),o=Ll(t[0]),u=parseInt(t[1]),m=parseInt(t[2]),f=t[3]===void 0?!1:H(t[3]);return[Ao(o,u,m,f)]}if($n){const t=$n[1].split(",").map(u=>u.trim()),o=G.includes(t[0].toLowerCase())?"":t[0];return[No(o)]}if(Vn){const t=Vn[1].split(",").map(m=>m.trim().toLowerCase()),{troop:o,troopValue:u}=bl(t[0]);return[Mo(o,u)]}if(cc)return[rt()];if(uc)return[Do()];if(lc)return[ko()];if(Bn){const t=Bn[1].split(",").map(m=>m.trim().toLowerCase()),o=parseInt(t[0]),u=parseInt(t[1]);return[Po(o,u)]}if(Hn){const t=Hn[1].split(",").map(u=>u.trim().toLowerCase()),o=t[0]===""?!1:H(t[0]);return[$o(o)]}if(Rn){const t=Rn[1].split(",").map(w=>w.trim().toLowerCase()),o=Tl(t[0]),u=parseInt(t[1]),{price:m,priceValue:f}=t[2]===void 0?{price:0,priceValue:0}:Fl(t[2]);return[Vo(o,u,m,f)]}if(mc)return[Ho()];if(pc)return[Ro()];if(hc)return[Bo()];if(dc)return[jo()];if(jn){const t=jn[1].split(",").map(w=>w.trim()),o=G.includes(t[0].toLowerCase())?"":t[0],u=t[1]===void 0?90:parseInt(t[1]),m=t[2]===void 0?100:parseInt(t[2]),f=t[3]===void 0?0:parseInt(t[3]);return[Wo(o,u,m,f)]}if(Wn){const t=Wn[1].split(",").map(w=>w.trim()),o=G.includes(t[0].toLowerCase())?"":t[0],u=t[1]===void 0?90:parseInt(t[1]),m=t[2]===void 0?100:parseInt(t[2]),f=t[3]===void 0?0:parseInt(t[3]);return[Go(o,u,m,f)]}if(Gn){const t=Gn[1].split(",").map(E=>E.trim()),o=Ct(t[0].toLowerCase()),u=G.includes(t[1].toLowerCase())?"":t[1],m=t[2]===void 0?90:parseInt(t[2]),f=t[3]===void 0?100:parseInt(t[3]),w=t[4]===void 0?0:parseInt(t[4]);return[xo(o,u,m,f,w)]}if(xn){const t=xn[1].split(",").map(u=>u.trim().toLowerCase()),o=je(t[0]);return[qo(o)]}if(qn){const t=qn[1].split(",").map(u=>u.trim().toLowerCase()),o=je(t[0]);return[Uo(o)]}if(Un){const t=Un[1].split(",").map(u=>u.trim().toLowerCase()),o=je(t[0]);return[zo(o)]}if(zn){const t=zn[1].split(",").map(u=>u.trim().toLowerCase()),o=je(t[0]);return[Jo(o)]}if(Jn){const t=Jn[1].split(",").map(f=>f.trim().toLowerCase()),o=parseInt(t[0]),u=parseInt(t[1]),m=parseInt(t[2]);return[Xo(o,u,m)]}if(Xn){const t=Xn[1].split(",").map(F=>F.trim()),o=parseInt(t[0]),u=G.includes(t[1].toLowerCase())?"":String(t[1]),m=parseInt(t[2]),f=G.includes(t[3].toLowerCase())?"":String(t[3]),w=parseInt(t[4]),E=G.includes(t[5].toLowerCase())?"":String(t[5]);return[Yo(o,u,m,f,w,E)]}if(Yn){const t=Yn[1].split(",").map(f=>f.trim()),o=Ct(t[0].toLowerCase()),u=G.includes(t[1].toLowerCase())?"":String(t[1]),m=t[2]===void 0?0:parseInt(t[2]);return[Ko(o,u,m)]}if(Kn){const t=Kn[1].split(",").map(u=>u.trim().toLowerCase()),o=_t(t[0]);return[Zo(o)]}if(Zn){const t=Zn[1].split(",").map(u=>u.trim().toLowerCase()),o=parseInt(t[0]);return[Qo(o)]}if(Qn){const t=Qn[1].split(",").map(m=>m.trim()),o=G.includes(t[0].toLowerCase())?"":String(t[0]),u=G.includes(t[1].toLowerCase())?"":String(t[1]);return[ei(o,u)]}if(es){const t=es[1].split(",").map(We=>We.trim()),o=G.includes(t[0].toLowerCase())?"":String(t[0]),u=/(.*?)\[(-?\d+)]/,m=t[1]===void 0?void 0:t[1].match(u),f=t[2]===void 0?void 0:t[2].match(u);let w=!1,E=!1,F=0,V=0;return m!==void 0&&(Cs.includes(m[1].toLowerCase())?(w=!0,F=parseInt(m[2])):Es.includes(m[1].toLowerCase())&&(E=!0,V=parseInt(m[2]))),f!==void 0&&(Cs.includes(f[1].toLowerCase())?(w=!0,F=parseInt(f[2])):Es.includes(f[1].toLowerCase())&&(E=!0,V=parseInt(f[2]))),[ti(o,w,E,F,V)]}if(ts){const t=ts[1].split(",").map(V=>V.trim().toLowerCase()),o=parseInt(t[0]),u=Ol(t[1]),m=/^(.*?)\[(.*?)](\[(\d+)])?/,f=t[2].match(m);if(!f)throw new Error("Syntax error. / 文法エラーです。:"+t[2]);const{locationType:w,locationX:E,locationY:F}=wl(f[1],f[2],f[4]);return[ni(o,u,w,E,F)]}if(ns){const t=ns[1].split(",").map(E=>E.trim().toLowerCase()),o=_e(t[0]),u=x(t[1]),{operand:m,operandValue:f}=q(t[2]),w=t[3]===void 0?!1:H(t[3]);return[si(o,u,m,f,w)]}if(ss){const t=ss[1].split(",").map(w=>w.trim().toLowerCase()),o=_e(t[0]),u=x(t[1]),{operand:m,operandValue:f}=q(t[2]);return[ri(o,u,m,f)]}if(rs){const t=rs[1].split(",").map(w=>w.trim().toLowerCase()),o=_e(t[0]),u=x(t[1]),{operand:m,operandValue:f}=q(t[2]);return[ai(o,u,m,f)]}if(as){const t=as[1].split(",").map(f=>f.trim().toLowerCase()),o=_e(t[0]),u=gt(t[1]),m=parseInt(t[2]);return[oi(o,u,m)]}if(os){const t=os[1].split(",").map(u=>u.trim().toLowerCase()),o=_e(t[0]);return[ii(o)]}if(is){const t=is[1].split(",").map(u=>u.trim().toLowerCase()),o=_e(t[0]);return[ci(o)]}if(cs){const t=cs[1].split(",").map(m=>m.trim().toLowerCase()),o=_e(t[0]),u=parseInt(t[1]);return[ui(o,u)]}if(us){const t=us[1].split(",").map(f=>f.trim().toLowerCase()),{enemyValue:o,isAllChecked:u}=Nl(t[0]),m=parseInt(t[1]);return[li(o,m,u)]}if(ls){const t=ls[1].split(",").map(w=>w.trim().toLowerCase()),{subject:o,subjectValue:u}=_l(t[0]),m=parseInt(t[1]),f=Al(t[2]);return[mi(o,u,m,f)]}return fc?[pi()]:(e.match(/\S/g)&&(b.log("push: ",e),ft.push(sr(e))),ft)},fi=function(e,r,i,p,h,g){let C=[];const d=di(e,i,h,g),I=101,A=102,D=401,P=402,j=403,J=111,B=302,K=605,Ie=He().code,ot=$t().code,it=Ht().code,Le=301,Te=601,ct=602,Fe=603,ve=205,ut=505;if(d.forEach(T=>{(T.code===Ie||T.code===ot||T.code===it)&&h.pop()}),Array.isArray(d)&&d.length>0){if(d.length>1)return C=C.concat(d),{window_frame:null,event_command_list:C,block_stack:h};const T=d[0];if(T.code===I)return i=T,{window_frame:i,event_command_list:C,block_stack:h};if(T.code===D)p?p.code===D?r===""&&C.push(ie()):p.code===I?C.push(i):C.push(ie()):C.push(ie());else if(T.code===P){const W=h.slice(-1)[0].index,re=h.slice(-1)[0].event;W!==0&&C.push(Ee()),T.parameters[0]=W,h.slice(-1)[0].index+=1,re&&Array.isArray(re.parameters)&&re.parameters[0].push(T.parameters[1])}else if(T.code===j)h.slice(-1)[0].index!==0&&C.push(Ee()),h.slice(-1)[0].index+=1;else if(T.code===Te)h.slice(-1)[0].winCode=!0;else if(T.code===ct){h.slice(-1)[0].winCode===!1&&(C.push(rt()),h.slice(-1)[0].winCode=!0);const W=h.slice(-1)[0].event;C.push(Ee()),W.parameters[2]=!0}else if(T.code===Fe){h.slice(-1)[0].winCode===!1&&(C.push(rt()),h.slice(-1)[0].winCode=!0);const W=h.slice(-1)[0].event;C.push(Ee()),W.parameters[3]=!0}else T.code===A?h.push({code:T.code,event:T,indent:h.length,index:0}):T.code===J?h.push({code:T.code,event:T,indent:h.length,index:0}):T.code===Le?h.push({code:T.code,event:T,indent:h.length,winCode:!1}):T.code===ve&&h.push({code:T.code,event:T,indent:h.length});if(T.code===K&&p.code===B&&p.parameters[1]===0&&(p.parameters[0]=T.parameters[0],p.parameters[1]=T.parameters[1],p.parameters[2]=T.parameters[2],p.parameters[3]=T.parameters[3],d.pop()),T.code===ut){const W=h.slice(-1)[0].event;if(W.code===ve){const re=T.parameters[0],Re=W.parameters[1].list.pop();W.parameters[1].list.push(re),W.parameters[1].list.push(Re)}}C=C.concat(d)}return{window_frame:null,event_command_list:C,block_stack:h}},gi=function(e){return e.reduce((P,j)=>{const J=JSON.parse(JSON.stringify(j.parameters));let B=0;const K=P.slice(-1)[0];if(K!==void 0)switch(B=K.indent,K.code){case 111:case 411:case 112:case 402:case 601:case 602:case 603:case 403:{B+=1;break}case 0:B-=1;break}return P.push({code:j.code,indent:B,parameters:J}),P},[])},Rt=function(e){let r=R(e);r=Y(r,n.Text2Frame.CommentOutChar);let i={};["script","comment","scrolling"].forEach(function(I){const A=Lr(r,I);r=A.scenario_text,i=Object.assign(i,A.block_map)});const p=r.split(`
`);let h=[],g="",C=null,d=[];for(let I=0;I<p.length;I++){const A=p[I];if(A){let D=C;D===null&&(D=h.slice(-1)[0]);const P=fi(A,g,C,D,d,i);C=P.window_frame;const j=P.event_command_list;d=P.block_stack,h=h.concat(j)}b.log(I,A),g=A}return h=hi(h),h=gi(h),h};if(n.Text2Frame.export={compile:Rt},n.Text2Frame.ExecMode==="LIBRARY_EXPORT")return;const _i=y(n.Text2Frame.TextPath),at=Rt(_i);switch(at.push(Se()),n.Text2Frame.ExecMode){case"IMPORT_MESSAGE_TO_EVENT":case"メッセージをイベントにインポート":{const e=L(n.Text2Frame.MapPath);if(!e.events[n.Text2Frame.EventID])throw new Error(`EventID not found. / EventIDが見つかりません。
Event ID: `+n.Text2Frame.EventID);const r=Number(n.Text2Frame.PageID)-1;for(;!e.events[n.Text2Frame.EventID].pages[r];)e.events[n.Text2Frame.EventID].pages.push(O());let i=e.events[n.Text2Frame.EventID].pages[r].list;n.Text2Frame.IsOverwrite&&(i=[]),i.pop(),i=i.concat(at),e.events[n.Text2Frame.EventID].pages[r].list=i,N(n.Text2Frame.MapPath,e),l(`Success / 書き出し成功！
======> MapID: `+n.Text2Frame.MapID+" -> EventID: "+n.Text2Frame.EventID+" -> PageID: "+n.Text2Frame.PageID);break}case"IMPORT_MESSAGE_TO_CE":case"メッセージをコモンイベントにインポート":{const e=L(n.Text2Frame.CommonEventPath);if(e.length-1<n.Text2Frame.CommonEventID)throw new Error("Common Event not found. / コモンイベントが見つかりません。: "+n.Text2Frame.CommonEventID);let r=e[n.Text2Frame.CommonEventID].list;n.Text2Frame.IsOverwrite&&(r=[]),r.pop(),e[n.Text2Frame.CommonEventID].list=r.concat(at),N(n.Text2Frame.CommonEventPath,e),l(`Success / 書き出し成功！
=====> Common EventID :`+n.Text2Frame.CommonEventID);break}}l(`
`),l(`Please restart RPG Maker MV(Editor) WITHOUT save. 
**セーブせずに**プロジェクトファイルを開き直してください`),console.log(`Please restart RPG Maker MV(Editor) WITHOUT save. 
**セーブせずに**プロジェクトファイルを開き直してください`)},Game_Interpreter.prototype.pluginCommandText2Frame("LIBRARY_EXPORT",[0]),v.exports=n.Text2Frame.export}(),typeof Et<"u"&&typeof require.main<"u"&&require.main===v){const n=er;n.version("2.2.1").usage("[options]").option("-m, --mode <map|common|compile|test>","output mode",/^(map|common|compile|test)$/i).option("-t, --text_path <name>","text file path").option("-o, --output_path <name>","output file path").option("-e, --event_id <name>","event file id").option("-p, --page_id <name>","page id").option("-c, --common_event_id <name>","common event id").option("-w, --overwrite <true/false>","overwrite mode","false").option("-v, --verbose","debug mode",!1).parse(),n.addHelpText("after",`
===== Manual =====
    NAME
       Text2Frame - Simple compiler to convert text to event command.
    SYNOPSIS
        node Text2Frame.js --verbose --mode map --text_path <text file path> --output_path <output file path> --event_id <event id> --page_id <page id> --overwrite <true|false>
        node Text2Frame.js --verbose --mode common --text_path <text file path> --common_event_id <common event id> --overwrite <true|false>
        node Text2Frame.js --mode compile
        node Text2Frame.js --verbose --mode test
    DESCRIPTION
        node Text2Frame.js --verbose --mode map --text_path <text file path> --output_path <output file path> --event_id <event id> --page_id <page id> --overwrite <true|false>
          マップへのイベント出力モードです。
          読み込むファイル、出力マップ、上書きの有無を引数で指定します。
          test/basic.txt を読み込み data/Map001.json に上書きするコマンド例は以下です。

          例1：$ node Text2Frame.js --mode map --text_path test/basic.txt --output_path data/Map001.json --event_id 1 --page_id 1 --overwrite true
          例2：$ node Text2Frame.js -m map -t test/basic.txt -o data/Map001.json -e 1 -p 1 -w true

        node Text2Frame.js --verbose --mode common --text_path <text file path> --common_event_id <common event id> --overwrite <true|false>
          コモンイベントへのイベント出力モードです。
          読み込むファイル、出力コモンイベント、上書きの有無を引数で指定します。
          test/basic.txt を読み込み data/CommonEvents.json に上書きするコマンド例は以下です。

          例1：$ node Text2Frame.js --mode common --text_path test/basic.txt --output_path data/CommonEvents.json --common_event_id 1 --overwrite true
          例2：$ node Text2Frame.js -m common -t test/basic.txt -o data/CommonEvents.json -c 1 -w true

        node Text2Frame.js --mode compile
          コンパイルモードです。
          変換したいテキストファイルをパイプで与えると、対応したイベントに変換されたJSONを、標準出力に出力します。
          このモードでは、Map.json / CommonEvent.jsonの形式へフォーマットされず、イベントに変換したJSONのみが出力されるため、
          Map.json/CommonEvent.json への組み込みは各自で行う必要があります。

          例1: $ cat test/basic.txt | node Text2Frame.js --mode compile

        node Text2Frame.js --mode test
          テストモードです。test/basic.txtを読み込み、data/Map001.jsonに出力します。

`);const a=n.opts();if(["map","common","compile","test"].includes(a.mode)||(n.help(),process.exit(0)),a.mode==="map"){const c={IsDebug:a.verbose,TextPath:a.text_path,IsOverwrite:a.overwrite==="true",ExecMode:"IMPORT_MESSAGE_TO_EVENT",MapPath:a.output_path,EventID:a.event_id,PageID:a.page_id?a.page_id:"1"};Game_Interpreter.prototype.pluginCommandText2Frame("COMMAND_LINE",[c])}else if(a.mode==="common"){const c={IsDebug:a.verbose,TextPath:a.text_path,IsOverwrite:a.overwrite==="true",ExecMode:"IMPORT_MESSAGE_TO_CE",CommonEventPath:a.output_path,CommonEventID:a.common_event_id};Game_Interpreter.prototype.pluginCommandText2Frame("COMMAND_LINE",[c])}else if(a.mode==="compile"){process.stdin.setEncoding("utf8");let c="";process.stdin.on("readable",()=>{let l;for(;(l=process.stdin.read())!==null;)c+=l}),process.stdin.on("end",()=>{console.log(JSON.stringify(v.exports.compile(c),null,2))})}else if(a.mode==="test"){const c={IsDebug:a.verbose,MapID:"1",EventID:"1",PageID:"1",IsOverwrite:!0,TextPath:"test/basic.txt",MapPath:"data/Map001.json"};Game_Interpreter.prototype.pluginCommandText2Frame("COMMAND_LINE",[c])}}}(qe);var tr=qe.exports;return be(tr)});
